(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4943:function(t,e){},363:function(t,e){},9888:function(t,e,n){n(363),n(4943)},7083:function(t,e,n){"use strict";var i=n(7790),r=n(5272),s=n(1176),o=!1,a=n(3558).i8,h="locals",f=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],u=f.concat("cache"),c=/^\uFEFF/;function l(t,n){var r;if(n.some((function(n){return r=e.resolveInclude(t,n,!0),i.existsSync(r)})))return r}function p(t,n){var i,r=t.filename,s=arguments.length>1;if(t.cache){if(!r)throw new Error("cache option requires a filename");if(i=e.cache.get(r))return i;s||(n=m(r).toString().replace(c,""))}else if(!s){if(!r)throw new Error("Internal EJS error: no file name or template provided");n=m(r).toString().replace(c,"")}return i=e.compile(n,t),t.cache&&e.cache.set(r,i),i}function g(t,n,i){var r;if(!i){if("function"==typeof e.promiseImpl)return new e.promiseImpl((function(e,i){try{e(r=p(t)(n))}catch(s){i(s)}}));throw new Error("Please provide a callback function")}try{r=p(t)(n)}catch(s){return i(s)}i(null,r)}function m(t){return e.fileLoader(t)}function d(t,n){var r=s.shallowCopy({},n);if(r.filename=function(t,n){var r,s,o=n.views,a=/^[A-Za-z]+:\\|^\//.exec(t);if(a&&a.length)t=t.replace(/^\/*/,""),r=Array.isArray(n.root)?l(t,n.root):e.resolveInclude(t,n.root||"/",!0);else if(n.filename&&(s=e.resolveInclude(t,n.filename),i.existsSync(s)&&(r=s)),!r&&Array.isArray(o)&&(r=l(t,o)),!r&&"function"!==typeof n.includer)throw new Error('Could not find the include file "'+n.escapeFunction(t)+'"');return r}(t,r),"function"===typeof n.includer){var o=n.includer(t,r.filename);if(o&&(o.filename&&(r.filename=o.filename),o.template))return p(r,o.template)}return p(r)}function b(t,e,n,i,r){var s=e.split("\n"),o=Math.max(i-3,0),a=Math.min(s.length,i+3),h=r(n),f=s.slice(o,a).map((function(t,e){var n=e+o+1;return(n==i?" >> ":"    ")+n+"| "+t})).join("\n");throw t.path=h,t.message=(h||"ejs")+":"+i+"\n"+f+"\n\n"+t.message,t}function w(t){return t.replace(/;(\s*$)/,"$1")}function y(t,n){n=n||{};var i={};this.templateText=t,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",i.client=n.client||!1,i.escapeFunction=n.escape||n.escapeFunction||s.escapeXML,i.compileDebug=!1!==n.compileDebug,i.debug=!!n.debug,i.filename=n.filename,i.openDelimiter=n.openDelimiter||e.openDelimiter||"<",i.closeDelimiter=n.closeDelimiter||e.closeDelimiter||">",i.delimiter=n.delimiter||e.delimiter||"%",i.strict=n.strict||!1,i.context=n.context,i.cache=n.cache||!1,i.rmWhitespace=n.rmWhitespace,i.root=n.root,i.includer=n.includer,i.outputFunctionName=n.outputFunctionName,i.localsName=n.localsName||e.localsName||h,i.views=n.views,i.async=n.async,i.destructuredLocals=n.destructuredLocals,i.legacyInclude="undefined"==typeof n.legacyInclude||!!n.legacyInclude,i.strict?i._with=!1:i._with="undefined"==typeof n._with||n._with,this.opts=i,this.regex=this.createRegex()}e.cache=s.cache,e.fileLoader=i.readFileSync,e.localsName=h,e.promiseImpl=new Function("return this;")().Promise,e.resolveInclude=function(t,e,n){var i=r.dirname,s=r.extname,o=(0,r.resolve)(n?e:i(e),t);return s(t)||(o+=".ejs"),o},e.compile=function(t,e){return e&&e.scope&&(o||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),o=!0),e.context||(e.context=e.scope),delete e.scope),new y(t,e).compile()},e.render=function(t,e,n){var i=e||{},r=n||{};return 2==arguments.length&&s.shallowCopyFromList(r,i,f),p(r,t)(i)},e.renderFile=function(){var t,e,n,i=Array.prototype.slice.call(arguments),r=i.shift(),o={filename:r};return"function"==typeof arguments[arguments.length-1]&&(t=i.pop()),i.length?(e=i.shift(),i.length?s.shallowCopy(o,i.pop()):(e.settings&&(e.settings.views&&(o.views=e.settings.views),e.settings["view cache"]&&(o.cache=!0),(n=e.settings["view options"])&&s.shallowCopy(o,n)),s.shallowCopyFromList(o,e,u)),o.filename=r):e={},g(o,e,t)},e.Template=y,e.clearCache=function(){e.cache.reset()},y.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},y.prototype={createRegex:function(){var t="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",e=s.escapeRegExpChars(this.opts.delimiter),n=s.escapeRegExpChars(this.opts.openDelimiter),i=s.escapeRegExpChars(this.opts.closeDelimiter);return t=t.replace(/%/g,e).replace(/</g,n).replace(/>/g,i),new RegExp(t)},compile:function(){var t,e,n,i=this.opts,o="",a="",h=i.escapeFunction,f=i.filename?JSON.stringify(i.filename):"undefined";if(!this.source){if(this.generateSource(),o+='  var __output = "";\n  function __append(s) { if (s !== undefined && s !== null) __output += s }\n',i.outputFunctionName&&(o+="  var "+i.outputFunctionName+" = __append;\n"),i.destructuredLocals&&i.destructuredLocals.length){for(var u="  var __locals = ("+i.localsName+" || {}),\n",c=0;c<i.destructuredLocals.length;c++){var l=i.destructuredLocals[c];c>0&&(u+=",\n  "),u+=l+" = __locals."+l}o+=u+";\n"}!1!==i._with&&(o+="  with ("+i.localsName+" || {}) {\n",a+="  }\n"),a+="  return __output;\n",this.source=o+this.source+a}t=i.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+f+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,i.client&&(t="escapeFn = escapeFn || "+h.toString()+";\n"+t,i.compileDebug&&(t="rethrow = rethrow || "+b.toString()+";\n"+t)),i.strict&&(t='"use strict";\n'+t),i.debug&&console.log(t),i.compileDebug&&i.filename&&(t=t+"\n//# sourceURL="+f+"\n");try{if(i.async)try{n=new Function("return (async function(){}).constructor;")()}catch(w){throw w instanceof SyntaxError?new Error("This environment does not support async/await"):w}else n=Function;e=new n(i.localsName+", escapeFn, include, rethrow",t)}catch(w){throw w instanceof SyntaxError&&(i.filename&&(w.message+=" in "+i.filename),w.message+=" while compiling ejs\n\n",w.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",w.message+="https://github.com/RyanZim/EJS-Lint",i.async||(w.message+="\n",w.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),w}var p=i.client?e:function(t){return e.apply(i.context,[t||{},h,function(e,n){var r=s.shallowCopy({},t);return n&&(r=s.shallowCopy(r,n)),d(e,i)(r)},b])};if(i.filename&&"function"===typeof Object.defineProperty){var g=i.filename,m=r.basename(g,r.extname(g));try{Object.defineProperty(p,"name",{value:m,writable:!1,enumerable:!1,configurable:!0})}catch(w){}}return p},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var t=this,e=this.parseTemplateText(),n=this.opts.delimiter,i=this.opts.openDelimiter,r=this.opts.closeDelimiter;e&&e.length&&e.forEach((function(s,o){var a;if(0===s.indexOf(i+n)&&0!==s.indexOf(i+n+n)&&(a=e[o+2])!=n+r&&a!="-"+n+r&&a!="_"+n+r)throw new Error('Could not find matching close tag for "'+s+'".');t.scanLine(s)}))},parseTemplateText:function(){for(var t,e=this.templateText,n=this.regex,i=n.exec(e),r=[];i;)0!==(t=i.index)&&(r.push(e.substring(0,t)),e=e.slice(t)),r.push(i[0]),e=e.slice(i[0].length),i=n.exec(e);return e&&r.push(e),r},_addOutput:function(t){if(this.truncate&&(t=t.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!t)return t;t=(t=(t=(t=t.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+t+'")\n'},scanLine:function(t){var e,n=this.opts.delimiter,i=this.opts.openDelimiter,r=this.opts.closeDelimiter;switch(e=t.split("\n").length-1,t){case i+n:case i+n+"_":this.mode=y.modes.EVAL;break;case i+n+"=":this.mode=y.modes.ESCAPED;break;case i+n+"-":this.mode=y.modes.RAW;break;case i+n+"#":this.mode=y.modes.COMMENT;break;case i+n+n:this.mode=y.modes.LITERAL,this.source+='    ; __append("'+t.replace(i+n+n,i+n)+'")\n';break;case n+n+r:this.mode=y.modes.LITERAL,this.source+='    ; __append("'+t.replace(n+n+r,n+r)+'")\n';break;case n+r:case"-"+n+r:case"_"+n+r:this.mode==y.modes.LITERAL&&this._addOutput(t),this.mode=null,this.truncate=0===t.indexOf("-")||0===t.indexOf("_");break;default:if(this.mode){switch(this.mode){case y.modes.EVAL:case y.modes.ESCAPED:case y.modes.RAW:t.lastIndexOf("//")>t.lastIndexOf("\n")&&(t+="\n")}switch(this.mode){case y.modes.EVAL:this.source+="    ; "+t+"\n";break;case y.modes.ESCAPED:this.source+="    ; __append(escapeFn("+w(t)+"))\n";break;case y.modes.RAW:this.source+="    ; __append("+w(t)+")\n";break;case y.modes.COMMENT:break;case y.modes.LITERAL:this._addOutput(t)}}else this._addOutput(t)}this.opts.compileDebug&&e&&(this.currentLine+=e,this.source+="    ; __line = "+this.currentLine+"\n")}},e.escapeXML=s.escapeXML,e.__express=e.renderFile,e.VERSION=a,e.name="ejs","undefined"!=typeof window&&(window.ejs=e)},1176:function(t,e){"use strict";var n=/[|\\{}()[\]^$+*?.]/g;e.escapeRegExpChars=function(t){return t?String(t).replace(n,"\\$&"):""};var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},r=/[&<>'"]/g;function s(t){return i[t]||t}e.escapeXML=function(t){return void 0==t?"":String(t).replace(r,s)},e.escapeXML.toString=function(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'},e.shallowCopy=function(t,e){for(var n in e=e||{})t[n]=e[n];return t},e.shallowCopyFromList=function(t,e,n){for(var i=0;i<n.length;i++){var r=n[i];"undefined"!=typeof e[r]&&(t[r]=e[r])}return t},e.cache={_data:{},set:function(t,e){this._data[t]=e},get:function(t){return this._data[t]},remove:function(t){delete this._data[t]},reset:function(){this._data={}}},e.hyphenToCamel=function(t){return t.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))}},3544:function(t,e,n){var i=n(8764).Buffer,r=n(2825),s=n(7187).EventEmitter,o=n(9539),a=t.exports=function(t,e){if(!(this instanceof a))return new a(t,e);s.call(this),(e=e||{}).maxLineLength=e.maxLineLength||4096,e.retainBuffer=!!e.retainBuffer;var n=this,o=new i(e.maxLineLength),h=0,f=0,u=0,c=function(t,i){try{var r=o.slice(0,h);n.emit("line",e.retainBuffer?r:r.toString(),t,i)}catch(s){n.emit("error",s)}finally{h=0}};this.input="string"===typeof t?r.createReadStream(t,e):t,this.input.on("open",(function(t){n.emit("open",t)})).on("data",(function(t){for(var e=0;e<t.length;e++)10==t[e]||13==t[e]?10==t[e]&&(f++,c(f,u)):(o[h]=t[e],h++),u++})).on("error",(function(t){n.emit("error",t)})).on("end",(function(){h&&(f++,c(f,u)),n.emit("end")})).on("close",(function(){n.emit("close")}))};o.inherits(a,s)},974:function(t,e,n){"use strict";n.d(e,{L3:function(){return ua},iZ:function(){return fa}});var i={};n.r(i),n.d(i,{abs:function(){return K},add:function(){return D},band:function(){return ot},bitLength:function(){return z},bits:function(){return j},bor:function(){return at},bxor:function(){return ht},div:function(){return X},e:function(){return S},eq:function(){return tt},exp:function(){return Q},fromArray:function(){return x},fromString:function(){return q},geq:function(){return st},gt:function(){return it},isNegative:function(){return U},isOdd:function(){return k},isZero:function(){return R},land:function(){return ft},leq:function(){return rt},lnot:function(){return ct},lor:function(){return ut},lt:function(){return nt},mod:function(){return Y},mul:function(){return V},naf:function(){return G},neg:function(){return W},neq:function(){return et},pow:function(){return H},shiftLeft:function(){return C},shiftRight:function(){return M},shl:function(){return N},shr:function(){return T},square:function(){return J},sub:function(){return Z},toArray:function(){return $},toNumber:function(){return P}});var r={};n.r(r),n.d(r,{abs:function(){return Ct},add:function(){return Ot},band:function(){return Dt},bitLength:function(){return dt},bits:function(){return At},bor:function(){return Zt},bxor:function(){return Wt},div:function(){return Mt},e:function(){return gt},eq:function(){return Tt},exp:function(){return Rt},fromArray:function(){return mt},fromString:function(){return pt},geq:function(){return $t},gt:function(){return jt},isNegative:function(){return bt},isOdd:function(){return Bt},isZero:function(){return wt},land:function(){return Vt},leq:function(){return Pt},lnot:function(){return Ht},lor:function(){return Jt},lt:function(){return Gt},mod:function(){return Nt},mul:function(){return xt},naf:function(){return Et},neg:function(){return St},neq:function(){return kt},pow:function(){return Ut},shiftLeft:function(){return yt},shiftRight:function(){return vt},shl:function(){return Lt},shr:function(){return _t},square:function(){return zt},sub:function(){return qt},toArray:function(){return It},toNumber:function(){return Ft}});var s={};n.r(s),n.d(s,{abs:function(){return Oe},add:function(){return Le},band:function(){return Ne},bitLength:function(){return fe},bits:function(){return we},bor:function(){return Te},bxor:function(){return ke},div:function(){return qe},e:function(){return ae},eq:function(){return xe},exp:function(){return Ie},fromArray:function(){return he},fromRprBE:function(){return ee},fromRprLE:function(){return te},fromString:function(){return oe},geq:function(){return Me},gt:function(){return Re},isNegative:function(){return ue},isOdd:function(){return de},isZero:function(){return ce},land:function(){return Ge},leq:function(){return Ce},lnot:function(){return Pe},lor:function(){return je},lt:function(){return Ue},mod:function(){return Se},mul:function(){return Ee},naf:function(){return be},neg:function(){return Be},neq:function(){return ze},one:function(){return se},pow:function(){return Fe},shiftLeft:function(){return le},shiftRight:function(){return pe},shl:function(){return ge},shr:function(){return me},square:function(){return Ae},sub:function(){return _e},toArray:function(){return ve},toLEBuff:function(){return ie},toNumber:function(){return ye},toRprBE:function(){return Yt},toRprLE:function(){return Xt},toString:function(){return ne},zero:function(){return re}});var o={};n.r(o),n.d(o,{beBuff2int:function(){return an},beInt2Buff:function(){return hn},leBuff2int:function(){return fn},leInt2Buff:function(){return un},stringifyBigInts:function(){return sn},stringifyFElements:function(){return cn},unstringifyBigInts:function(){return on},unstringifyFElements:function(){return ln}});var a={};n.r(a),n.d(a,{beBuff2int:function(){return mn},beInt2Buff:function(){return dn},leBuff2int:function(){return bn},leInt2Buff:function(){return wn},stringifyBigInts:function(){return pn},unstringifyBigInts:function(){return gn}});var h={};n.r(h),n.d(h,{array2buffer:function(){return xn},beBuff2int:function(){return In},beInt2Buff:function(){return On},bitReverse:function(){return _n},buffReverseBits:function(){return En},buffer2array:function(){return zn},leBuff2int:function(){return qn},leInt2Buff:function(){return Sn},log2:function(){return Bn},stringifyBigInts:function(){return An},stringifyFElements:function(){return Un},unstringifyBigInts:function(){return Fn},unstringifyFElements:function(){return Rn}});var f={};n.r(f),n.d(f,{abs:function(){return Sr},add:function(){return Br},band:function(){return kr},bitLength:function(){return cr},bits:function(){return vr},bor:function(){return Gr},bxor:function(){return jr},div:function(){return xr},e:function(){return fr},eq:function(){return Ur},exp:function(){return qr},fromArray:function(){return ur},fromString:function(){return hr},geq:function(){return Tr},gt:function(){return Mr},isNegative:function(){return lr},isOdd:function(){return wr},isZero:function(){return pr},land:function(){return Pr},leq:function(){return Nr},lnot:function(){return Dr},lor:function(){return $r},lt:function(){return Cr},mod:function(){return zr},mul:function(){return Fr},naf:function(){return yr},neg:function(){return Ar},neq:function(){return Rr},pow:function(){return Or},shiftLeft:function(){return gr},shiftRight:function(){return mr},shl:function(){return dr},shr:function(){return br},square:function(){return Ir},sub:function(){return Er},toArray:function(){return _r},toNumber:function(){return Lr}});var u={};n.r(u),n.d(u,{abs:function(){return ps},add:function(){return os},band:function(){return _s},bitLength:function(){return Jr},bits:function(){return is},bor:function(){return Bs},bxor:function(){return Es},div:function(){return gs},e:function(){return Wr},eq:function(){return ds},exp:function(){return ls},fromArray:function(){return Vr},fromString:function(){return Zr},geq:function(){return Ls},gt:function(){return ys},isNegative:function(){return Hr},isOdd:function(){return es},isZero:function(){return Qr},land:function(){return As},leq:function(){return vs},lnot:function(){return Is},lor:function(){return Fs},lt:function(){return ws},mod:function(){return ms},mul:function(){return fs},naf:function(){return ns},neg:function(){return hs},neq:function(){return bs},pow:function(){return cs},shiftLeft:function(){return Kr},shiftRight:function(){return Xr},shl:function(){return Yr},shr:function(){return ts},square:function(){return us},sub:function(){return as},toArray:function(){return ss},toNumber:function(){return rs}});var c={};n.r(c),n.d(c,{beBuff2int:function(){return Ro},beInt2Buff:function(){return Co},leBuff2int:function(){return Mo},leInt2Buff:function(){return No},stringifyBigInts:function(){return zo},unstringifyBigInts:function(){return Uo}});var l={};n.r(l),n.d(l,{beBuff2int:function(){return Go},beInt2Buff:function(){return jo},leBuff2int:function(){return Po},leInt2Buff:function(){return $o},stringifyBigInts:function(){return To},unstringifyBigInts:function(){return ko}});var p=n(6441),g=n(6731),m=n(8197),d=n(9251),b=n(1581);const w=new RegExp("^bytes([0-9]+)$"),y=new RegExp("^(u?int)([0-9]*)$"),v=new RegExp("^(.*)\\[([0-9]*)\\]$"),L=new b.Yd("solidity/5.5.0");function _(t,e,n){switch(t){case"address":return n?(0,p.Bu)(e,32):(0,p.lE)(e);case"string":return(0,d.Y0)(e);case"bytes":return(0,p.lE)(e);case"bool":return e=e?"0x01":"0x00",n?(0,p.Bu)(e,32):(0,p.lE)(e)}let i=t.match(y);if(i){let r=parseInt(i[2]||"256");return(i[2]&&String(r)!==i[2]||r%8!==0||0===r||r>256)&&L.throwArgumentError("invalid number type","type",t),n&&(r=256),e=g.O$.from(e).toTwos(r),(0,p.Bu)(e,r/8)}if(i=t.match(w),i){const r=parseInt(i[1]);return(String(r)!==i[1]||0===r||r>32)&&L.throwArgumentError("invalid bytes type","type",t),(0,p.lE)(e).byteLength!==r&&L.throwArgumentError(`invalid value for ${t}`,"value",e),n?(0,p.lE)((e+"0000000000000000000000000000000000000000000000000000000000000000").substring(0,66)):e}if(i=t.match(v),i&&Array.isArray(e)){const n=i[1];parseInt(i[2]||String(e.length))!=e.length&&L.throwArgumentError(`invalid array length for ${t}`,"value",e);const r=[];return e.forEach((function(t){r.push(_(n,t,!0))})),(0,p.zo)(r)}return L.throwArgumentError("invalid type","type",t)}function B(t,e){t.length!=e.length&&L.throwArgumentError("wrong number of values; expected ${ types.length }","values",e);const n=[];return t.forEach((function(t,i){n.push(_(t,e[i]))})),(0,p.Dv)((0,p.zo)(n))}function E(t,e){return(0,m.w)(B(t,e))}var A=n(7218);function F(t){const e=(0,d.Y0)(t);if(e.length>31)throw new Error("bytes32 string must be less than 32 bytes");return(0,p.Dv)((0,p.zo)([e,A.R]).slice(0,32))}var I=n(3461);const O=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function q(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const S=q;function x(t,e){let n=BigInt(0);e=BigInt(e);for(let i=0;i<t.length;i++)n=n*e+BigInt(t[i]);return n}function z(t){const e=t.toString(16);return 4*(e.length-1)+O[parseInt(e[0],16)]}function U(t){return BigInt(t)<BigInt(0)}function R(t){return!t}function C(t,e){return BigInt(t)<<BigInt(e)}function M(t,e){return BigInt(t)>>BigInt(e)}const N=C,T=M;function k(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function G(t){let e=BigInt(t);const n=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));n.push(t),e-=BigInt(t)}else n.push(0);e>>=BigInt(1)}return n}function j(t){let e=BigInt(t);const n=[];for(;e;)e&BigInt(1)?n.push(1):n.push(0),e>>=BigInt(1);return n}function P(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)}function $(t,e){const n=[];let i=BigInt(t);for(e=BigInt(e);i;)n.unshift(Number(i%e)),i/=e;return n}function D(t,e){return BigInt(t)+BigInt(e)}function Z(t,e){return BigInt(t)-BigInt(e)}function W(t){return-BigInt(t)}function V(t,e){return BigInt(t)*BigInt(e)}function J(t){return BigInt(t)*BigInt(t)}function H(t,e){return BigInt(t)**BigInt(e)}function Q(t,e){return BigInt(t)**BigInt(e)}function K(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)}function X(t,e){return BigInt(t)/BigInt(e)}function Y(t,e){return BigInt(t)%BigInt(e)}function tt(t,e){return BigInt(t)==BigInt(e)}function et(t,e){return BigInt(t)!=BigInt(e)}function nt(t,e){return BigInt(t)<BigInt(e)}function it(t,e){return BigInt(t)>BigInt(e)}function rt(t,e){return BigInt(t)<=BigInt(e)}function st(t,e){return BigInt(t)>=BigInt(e)}function ot(t,e){return BigInt(t)&BigInt(e)}function at(t,e){return BigInt(t)|BigInt(e)}function ht(t,e){return BigInt(t)^BigInt(e)}function ft(t,e){return BigInt(t)&&BigInt(e)}function ut(t,e){return BigInt(t)||BigInt(e)}function ct(t){return!BigInt(t)}var lt=n(4736);function pt(t,e){return"string"==typeof t&&"0x"==t.slice(0,2)?lt(t.slice(2),16):lt(t,e)}const gt=pt;function mt(t,e){return lt.fromArray(t,e)}function dt(t){return lt(t).bitLength()}function bt(t){return lt(t).isNegative()}function wt(t){return lt(t).isZero()}function yt(t,e){return lt(t).shiftLeft(e)}function vt(t,e){return lt(t).shiftRight(e)}const Lt=yt,_t=vt;function Bt(t){return lt(t).isOdd()}function Et(t){let e=lt(t);const n=[];for(;e.gt(lt.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();n.push(t),e=e.minus(t)}else n.push(0);e=e.shiftRight(1)}return n}function At(t){let e=lt(t);const n=[];for(;e.gt(lt.zero);)e.isOdd()?n.push(1):n.push(0),e=e.shiftRight(1);return n}function Ft(t){if(!t.lt(lt("9007199254740992",10)))throw new Error("Number too big");return t.toJSNumber()}function It(t,e){return lt(t).toArray(e)}function Ot(t,e){return lt(t).add(lt(e))}function qt(t,e){return lt(t).minus(lt(e))}function St(t){return lt.zero.minus(lt(t))}function xt(t,e){return lt(t).times(lt(e))}function zt(t){return lt(t).square()}function Ut(t,e){return lt(t).pow(lt(e))}function Rt(t,e){return lt(t).pow(lt(e))}function Ct(t){return lt(t).abs()}function Mt(t,e){return lt(t).divide(lt(e))}function Nt(t,e){return lt(t).mod(lt(e))}function Tt(t,e){return lt(t).eq(lt(e))}function kt(t,e){return lt(t).neq(lt(e))}function Gt(t,e){return lt(t).lt(lt(e))}function jt(t,e){return lt(t).gt(lt(e))}function Pt(t,e){return lt(t).leq(lt(e))}function $t(t,e){return lt(t).geq(lt(e))}function Dt(t,e){return lt(t).and(lt(e))}function Zt(t,e){return lt(t).or(lt(e))}function Wt(t,e){return lt(t).xor(lt(e))}function Vt(t,e){return!lt(t).isZero()&&!lt(e).isZero()}function Jt(t,e){return!lt(t).isZero()||!lt(e).isZero()}function Ht(t){return lt(t).isZero()}const Qt="function"===typeof BigInt;let Kt={};Qt?Object.assign(Kt,i):Object.assign(Kt,r),Kt.toRprLE=function(t,e,n,i){const r="0000000"+n.toString(16),s=new Uint32Array(t.buffer,e,i/4),o=1+(4*(r.length-7)-1>>5);for(let a=0;a<o;a++)s[a]=parseInt(r.substring(r.length-8*a-8,r.length-8*a),16);for(let a=o;a<s.length;a++)s[a]=0;for(let a=4*s.length;a<i;a++)t[a]=Kt.toNumber(Kt.band(Kt.shiftRight(n,8*a),255))},Kt.toRprBE=function(t,e,n,i){const r="0000000"+n.toString(16),s=new DataView(t.buffer,t.byteOffset+e,i),o=1+(4*(r.length-7)-1>>5);for(let a=0;a<o;a++)s.setUint32(i-4*a-4,parseInt(r.substring(r.length-8*a-8,r.length-8*a),16),!1);for(let a=0;a<i/4-o;a++)s[a]=0},Kt.fromRprLE=function(t,e,n){n=n||t.byteLength,e=e||0;const i=new Uint32Array(t.buffer,e,n/4),r=new Array(n/4);return i.forEach(((t,e)=>r[r.length-e-1]=t.toString(16).padStart(8,"0"))),Kt.fromString(r.join(""),16)},Kt.fromRprBE=function(t,e,n){n=n||t.byteLength,e=e||0;const i=new DataView(t.buffer,t.byteOffset+e,n),r=new Array(n/4);for(let s=0;s<n/4;s++)r[s]=i.getUint32(4*s,!1).toString(16).padStart(8,"0");return Kt.fromString(r.join(""),16)},Kt.toString=function(t,e){return t.toString(e)},Kt.toLEBuff=function(t){const e=new Uint8Array(Math.floor((Kt.bitLength(t)-1)/8)+1);return Kt.toRprLE(e,0,t,e.byteLength),e},Kt.zero=Kt.e(0),Kt.one=Kt.e(1);let{toRprLE:Xt,toRprBE:Yt,fromRprLE:te,fromRprBE:ee,toString:ne,toLEBuff:ie,zero:re,one:se,fromString:oe,e:ae,fromArray:he,bitLength:fe,isNegative:ue,isZero:ce,shiftLeft:le,shiftRight:pe,shl:ge,shr:me,isOdd:de,naf:be,bits:we,toNumber:ye,toArray:ve,add:Le,sub:_e,neg:Be,mul:Ee,square:Ae,pow:Fe,exp:Ie,abs:Oe,div:qe,mod:Se,eq:xe,neq:ze,lt:Ue,gt:Re,leq:Ce,geq:Me,band:Ne,bor:Te,bxor:ke,land:Ge,lor:je,lnot:Pe}=Kt;const $e=[];for(let ca=0;ca<256;ca++)$e[ca]=De(ca,8);function De(t,e){let n=0,i=t;for(let r=0;r<e;r++)n<<=1,n|=1&i,i>>=1;return n}function Ze(t,e,n){if(ce(n))return t.one;const i=we(n);if(0==i.legth)return t.one;let r=e;for(let s=i.length-2;s>=0;s--)r=t.square(r),i[s]&&(r=t.mul(r,e));return r}function We(t){if(t.m%2==1)if(xe(Se(t.p,4),1))if(xe(Se(t.p,8),1))if(xe(Se(t.p,16),1))!function(t){t.sqrt_q=Fe(t.p,t.m),t.sqrt_s=0,t.sqrt_t=_e(t.sqrt_q,1);for(;!de(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=qe(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){const n=t.random();t.sqrt_z=t.pow(n,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=qe(_e(t.sqrt_t,1),2),t.sqrt=function(t){const e=this;if(e.isZero(t))return e.zero;let n=e.pow(t,e.sqrt_tm1d2);const i=e.pow(e.mul(e.square(n),t),2**(e.sqrt_s-1));if(e.eq(i,e.negone))return null;let r=e.sqrt_s,s=e.mul(t,n),o=e.mul(s,n),a=e.sqrt_z;for(;!e.eq(o,e.one);){let t=e.square(o),i=1;for(;!e.eq(t,e.one);)t=e.square(t),i++;n=a;for(let s=0;s<r-i-1;s++)n=e.square(n);a=e.square(n),o=e.mul(o,a),s=e.mul(s,n),r=i}return e.geq(s,e.zero)?s:e.neg(s)}}(t);else{if(!xe(Se(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!xe(Se(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else xe(Se(t.p,4),3)&&function(t){t.sqrt_q=Fe(t.p,t.m),t.sqrt_e1=qe(_e(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;const n=this.pow(e,this.sqrt_e1),i=this.mul(this.square(n),e);if(this.eq(i,this.negone))return null;const r=this.mul(n,e);return t.geq(r,t.zero)?r:t.neg(r)}}(t);else{const e=Se(Fe(t.p,t.m/2),4);1==e?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==e?function(t){t.sqrt_q=Fe(t.p,t.m/2),t.sqrt_e34=qe(_e(t.sqrt_q,3),4),t.sqrt_e12=qe(_e(t.sqrt_q,1),2),t.frobenius=function(e,n){return e%2==1?t.conjugate(n):n},t.sqrt=function(t){const e=this,n=e.pow(t,e.sqrt_e34),i=e.mul(e.square(n),t),r=e.mul(e.frobenius(1,i),i);if(e.eq(r,e.negone))return null;const s=e.mul(n,t);let o;if(e.eq(i,e.negone))o=e.mul(s,[e.F.zero,e.F.one]);else{const t=e.pow(e.add(e.one,i),e.sqrt_e12);o=e.mul(t,s)}return e.geq(o,e.zero)?o:e.neg(o)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}function Ve(t,e,n,i,r){t[e]=t[e]+t[n]>>>0,t[r]=(t[r]^t[e])>>>0,t[r]=(t[r]<<16|t[r]>>>16&65535)>>>0,t[i]=t[i]+t[r]>>>0,t[n]=(t[n]^t[i])>>>0,t[n]=(t[n]<<12|t[n]>>>20&4095)>>>0,t[e]=t[e]+t[n]>>>0,t[r]=(t[r]^t[e])>>>0,t[r]=(t[r]<<8|t[r]>>>24&255)>>>0,t[i]=t[i]+t[r]>>>0,t[n]=(t[n]^t[i])>>>0,t[n]=(t[n]<<7|t[n]>>>25&127)>>>0}class Je{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return Le(Ee(this.nextU32(),4294967296),this.nextU32())}nextBool(){return 1==(1&this.nextU32())}update(){for(let e=0;e<16;e++)this.buff[e]=this.state[e];for(let e=0;e<10;e++)Ve(t=this.buff,0,4,8,12),Ve(t,1,5,9,13),Ve(t,2,6,10,14),Ve(t,3,7,11,15),Ve(t,0,5,10,15),Ve(t,1,6,11,12),Ve(t,2,7,8,13),Ve(t,3,4,9,14);var t;for(let e=0;e<16;e++)this.buff[e]=this.buff[e]+this.state[e]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}n(456);function He(t){let e=new Uint8Array(t);if("undefined"!==typeof globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let n=0;n<t;n++)e[n]=4294967296*Math.random()>>>0;return e}let Qe=null;function Ke(){return Qe||(Qe=new Je(function(){const t=He(32),e=new Uint32Array(t.buffer),n=[];for(let i=0;i<8;i++)n.push(e[i]);return n}()),Qe)}class Xe{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=fe(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const e=this.negone>>this.one;this.nqr=this.two;let n=this.pow(this.nqr,e);for(;!this.eq(n,this.negone);)this.nqr=this.nqr+this.one,n=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),We(this)}e(t,e){let n;if(e?16==e&&(n=BigInt("0x"+t)):n=BigInt(t),n<0){let t=-n;return t>=this.p&&(t%=this.p),this.p-t}return n>=this.p?n%this.p:n}add(t,e){const n=t+e;return n>=this.p?n-this.p:n}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw new Error("Division by zero");return t/e}inv(t){if(!t)throw new Error("Division by zero");let e=this.zero,n=this.p,i=this.one,r=t%this.p;for(;r;){let t=n/r;[e,i]=[i,e-t*i],[n,r]=[r,n-t*r]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return Ze(this,t,e)}exp(t,e){return Ze(this,t,e)}band(t,e){const n=t&e&this.mask;return n>=this.p?n-this.p:n}bor(t,e){const n=(t|e)&this.mask;return n>=this.p?n-this.p:n}bxor(t,e){const n=(t^e)&this.mask;return n>=this.p?n-this.p:n}bnot(t){const e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){const n=t<<e&this.mask;return n>=this.p?n-this.p:n}{const n=this.p-e;return Number(n)<this.bitLength?t>>n:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{const n=this.p-e;if(Number(n)<this.bitLength){const e=t<<n&this.mask;return e>=this.p?e-this.p:e}return 0}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,n=this.nqr_to_t,i=this.pow(t,this.t),r=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),s=1;for(;t!=this.one;)s++,t=this.square(t);let o=n;for(let n=0;n<e-s-1;n++)o=this.square(o);e=s,n=this.square(o),i=this.mul(i,n),r=this.mul(r,o)}return r>this.p>>this.one&&(r=this.neg(r)),r}normalize(t,e){if((t=BigInt(t,e))<0){let e=-t;return e>=this.p&&(e%=this.p),this.p-e}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let e=this.zero;for(let n=0;n<t;n++)e=(e<<BigInt(8))+BigInt(He(1)[0]);return e%this.p}toString(t,e){let n;if(t>this.half){n="-"+(this.p-t).toString(e)}else n=t.toString(e);return n}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let n=0;n<this.n64;n++)e+=t.nextU64()<<BigInt(64*n);e&=this.mask}while(e>=this.p);return e=e*this.Ri%this.p,e}}class Ye{constructor(t){this.type="F1",this.one=lt.one,this.zero=lt.zero,this.p=lt(t),this.m=1,this.negone=this.p.minus(lt.one),this.two=lt(2),this.half=this.p.shiftRight(1),this.bitLength=this.p.bitLength(),this.mask=lt.one.shiftLeft(this.bitLength).minus(lt.one),this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=lt.one.shiftLeft(64*this.n64),this.Ri=this.inv(this.R);const e=this.negone.shiftRight(this.one);this.nqr=this.two;let n=this.pow(this.nqr,e);for(;!n.equals(this.negone);)this.nqr=this.nqr.add(this.one),n=this.pow(this.nqr,e);for(this.s=this.zero,this.t=this.negone;!this.t.isOdd();)this.s=this.s.add(this.one),this.t=this.t.shiftRight(this.one);this.nqr_to_t=this.pow(this.nqr,this.t),We(this)}e(t,e){const n=lt(t,e);return this.normalize(n)}add(t,e){let n=t.add(e);return n.geq(this.p)&&(n=n.minus(this.p)),n}sub(t,e){return t.geq(e)?t.minus(e):this.p.minus(e.minus(t))}neg(t){return t.isZero()?t:this.p.minus(t)}mul(t,e){return t.times(e).mod(this.p)}mulScalar(t,e){return t.times(lt(e)).mod(this.p)}square(t){return t.square().mod(this.p)}eq(t,e){return t.eq(e)}neq(t,e){return t.neq(e)}lt(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.lt(i)}gt(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.gt(i)}leq(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.leq(i)}geq(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.geq(i)}div(t,e){if(e.isZero())throw new Error("Division by zero");return t.times(e.modInv(this.p)).mod(this.p)}idiv(t,e){if(e.isZero())throw new Error("Division by zero");return t.divide(e)}inv(t){if(t.isZero())throw new Error("Division by zero");return t.modInv(this.p)}mod(t,e){return t.mod(e)}pow(t,e){return t.modPow(e,this.p)}exp(t,e){return t.modPow(e,this.p)}band(t,e){return t.and(e).and(this.mask).mod(this.p)}bor(t,e){return t.or(e).and(this.mask).mod(this.p)}bxor(t,e){return t.xor(e).and(this.mask).mod(this.p)}bnot(t){return t.xor(this.mask).mod(this.p)}shl(t,e){if(e.lt(this.bitLength))return t.shiftLeft(e).and(this.mask).mod(this.p);{const n=this.p.minus(e);return n.lt(this.bitLength)?this.shr(t,n):lt.zero}}shr(t,e){if(e.lt(this.bitLength))return t.shiftRight(e);{const n=this.p.minus(e);return n.lt(this.bitLength)?this.shl(t,n):lt.zero}}land(t,e){return t.isZero()||e.isZero()?lt.zero:lt.one}lor(t,e){return t.isZero()&&e.isZero()?lt.zero:lt.one}lnot(t){return t.isZero()?lt.one:lt.zero}sqrt_old(t){if(t.equals(this.zero))return this.zero;if(!this.pow(t,this.negone.shiftRight(this.one)).equals(this.one))return null;let e=parseInt(this.s),n=this.nqr_to_t,i=this.pow(t,this.t),r=this.pow(t,this.add(this.t,this.one).shiftRight(this.one));for(;!i.equals(this.one);){let t=this.square(i),s=1;for(;!t.equals(this.one);)s++,t=this.square(t);let o=n;for(let n=0;n<e-s-1;n++)o=this.square(o);e=s,n=this.square(o),i=this.mul(i,n),r=this.mul(r,o)}return r.greater(this.p.shiftRight(this.one))&&(r=this.neg(r)),r}normalize(t){return(t=lt(t)).isNegative()?this.p.minus(t.abs().mod(this.p)):t.mod(this.p)}random(){let t=lt(0),e=lt(this.p.square());for(;!e.isZero();)t=t.shiftLeft(8).add(lt(He(1)[0])),e=e.shiftRight(8);return t.mod(this.p)}toString(t,e){let n;if(t.lesserOrEquals(this.p.shiftRight(lt(1))))n=t.toString(e);else{n="-"+this.p.minus(t).toString(e)}return n}isZero(t){return t.isZero()}fromRng(t){let e;do{e=lt(0);for(let n=0;n<this.n64;n++)e=e.add(e,t.nextU64().shiftLeft(64*n));e=e.and(this.mask)}while(e.geq(this.p));return e=e.times(this.Ri).mod(this.q),e}}const tn="function"===typeof BigInt;let en;en=tn?Xe:Ye;class nn extends en{toRprLE(t,e,n){Xt(t,e,n,8*this.n64)}toRprBE(t,e,n){Yt(t,e,n,8*this.n64)}toRprBEM(t,e,n){return this.toRprBE(t,e,this.mul(this.R,n))}toRprLEM(t,e,n){return this.toRprLE(t,e,this.mul(this.R,n))}fromRprLE(t,e){return te(t,e,this.n8)}fromRprBE(t,e){return ee(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}}var rn=n(7571);function sn(t){if("bigint"==typeof t||void 0!==t.eq)return t.toString(10);if(t instanceof Uint8Array)return te(t,0);if(Array.isArray(t))return t.map(sn);if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=sn(t[n])})),e}return t}function on(t){if("string"==typeof t&&/^[0-9]+$/.test(t))return BigInt(t);if("string"==typeof t&&/^0x[0-9a-fA-F]+$/.test(t))return BigInt(t);if(Array.isArray(t))return t.map(on);if("object"==typeof t){if(null===t)return null;const e={};return Object.keys(t).forEach((n=>{e[n]=on(t[n])})),e}return t}function an(t){let e=BigInt(0),n=t.length,i=0;const r=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n>0;)n>=4?(n-=4,e+=BigInt(r.getUint32(n))<<BigInt(8*i),i+=4):n>=2?(n-=2,e+=BigInt(r.getUint16(n))<<BigInt(8*i),i+=2):(n-=1,e+=BigInt(r.getUint8(n))<<BigInt(8*i),i+=1);return e}function hn(t,e){let n=t;const i=new Uint8Array(e),r=new DataView(i.buffer);let s=e;for(;s>0;)s-4>=0?(s-=4,r.setUint32(s,Number(n&BigInt(4294967295))),n>>=BigInt(32)):s-2>=0?(s-=2,r.setUint16(s,Number(n&BigInt(65535))),n>>=BigInt(16)):(s-=1,r.setUint8(s,Number(n&BigInt(255))),n>>=BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function fn(t){let e=BigInt(0),n=0;const i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n<t.length;)n+4<=t.length?(e+=BigInt(i.getUint32(n,!0))<<BigInt(8*n),n+=4):n+4<=t.length?(e+=BigInt(i.getUint16(n,!0))<<BigInt(8*n),n+=2):(e+=BigInt(i.getUint8(n,!0))<<BigInt(8*n),n+=1);return e}function un(t,e){let n=t;"undefined"===typeof e&&0==(e=Math.floor((fe(t)-1)/8)+1)&&(e=1);const i=new Uint8Array(e),r=new DataView(i.buffer);let s=0;for(;s<e;)s+4<=e?(r.setUint32(s,Number(n&BigInt(4294967295)),!0),s+=4,n>>=BigInt(32)):s+2<=e?(r.setUint16(Number(s,n&BigInt(65535)),!0),s+=2,n>>=BigInt(16)):(r.setUint8(Number(s,n&BigInt(255)),!0),s+=1,n>>=BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function cn(t,e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return t.toString(t.e(e));if(Array.isArray(e))return e.map(cn.bind(this,t));if("object"==typeof e){const n={};return Object.keys(e).forEach((i=>{n[i]=cn(t,e[i])})),n}return e}function ln(t,e){if("string"==typeof e&&/^[0-9]+$/.test(e))return t.e(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return t.e(e);if(Array.isArray(e))return e.map(ln.bind(this,t));if("object"==typeof e){if(null===e)return null;const n={};return Object.keys(e).forEach((i=>{n[i]=ln(t,e[i])})),n}return e}function pn(t){if("bigint"==typeof t||void 0!==t.eq)return t.toString(10);if(Array.isArray(t))return t.map(pn);if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=pn(t[n])})),e}return t}function gn(t){if("string"==typeof t&&/^[0-9]+$/.test(t))return lt(t);if("string"==typeof t&&/^0x[0-9a-fA-F]+$/.test(t))return lt(t);if(Array.isArray(t))return t.map(gn);if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=gn(t[n])})),e}return t}function mn(t){let e=lt.zero;for(let n=0;n<t.length;n++){const i=lt(t[t.length-n-1]);e=e.add(i.shiftLeft(8*n))}return e}function dn(t,e){let n=t,i=e-1;const r=new Uint8Array(e);for(;n.gt(lt.zero)&&i>=0;){let t=Number(n.and(lt("255")));r[i]=t,i--,n=n.shiftRight(8)}if(!n.eq(lt.zero))throw new Error("Number does not fit in this length");return r}function bn(t){let e=lt.zero;for(let n=0;n<t.length;n++){const i=lt(t[n]);e=e.add(i.shiftLeft(8*n))}return e}function wn(t,e){let n=t,i=0;const r=new Uint8Array(e);for(;n.gt(lt.zero)&&i<r.length;){let t=Number(n.and(lt(255)));r[i]=t,i++,n=n.shiftRight(8)}if(!n.eq(lt.zero))throw new Error("Number does not fit in this length");return r}let yn={};"function"===typeof BigInt?Object.assign(yn,o):Object.assign(yn,a);const vn=[];for(let ca=0;ca<256;ca++)vn[ca]=Ln(ca,8);function Ln(t,e){let n=0,i=t;for(let r=0;r<e;r++)n<<=1,n|=1&i,i>>=1;return n}yn.bitReverse=function(t,e){return(vn[t>>>24]|vn[t>>>16&255]<<8|vn[t>>>8&255]<<16|vn[255&t]<<24)>>>32-e},yn.log2=function(t){return(0!==(4294901760&t)?(t&=4294901760,16):0)|(0!==(4278255360&t)?(t&=4278255360,8):0)|(0!==(4042322160&t)?(t&=4042322160,4):0)|(0!==(3435973836&t)?(t&=3435973836,2):0)|0!==(2863311530&t)},yn.buffReverseBits=function(t,e){const n=t.byteLength/e,i=yn.log2(n);if(n!=1<<i)throw new Error("Invalid number of pointers");for(let r=0;r<n;r++){const n=yn.bitReverse(r,i);if(r>n){const i=t.slice(r*e,(r+1)*e);t.set(t.slice(n*e,(n+1)*e),r*e),t.set(i,n*e)}}},yn.array2buffer=function(t,e){const n=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)n.set(t[i],i*e);return n},yn.buffer2array=function(t,e){const n=t.byteLength/e,i=new Array(n);for(let r=0;r<n;r++)i[r]=t.slice(r*e,r*e+e);return i};let{bitReverse:_n,log2:Bn,buffReverseBits:En,stringifyBigInts:An,unstringifyBigInts:Fn,beBuff2int:In,beInt2Buff:On,leBuff2int:qn,leInt2Buff:Sn,array2buffer:xn,buffer2array:zn,stringifyFElements:Un,unstringifyFElements:Rn}=yn;const Cn=1<<30;class Mn{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=Cn){const n=Math.min(t-e,Cn);this.buffers.push(new Uint8Array(n))}}slice(t,e){void 0===e&&(e=this.byteLength),void 0===t&&(t=0);const n=e-t,i=Math.floor(t/Cn);if(i==Math.floor((t+n-1)/Cn)||0==n)return this.buffers[i].slice(t%Cn,t%Cn+n);let r,s=i,o=t%Cn,a=n;for(;a>0;){const t=o+a>Cn?Cn-o:a,e=new Uint8Array(this.buffers[s].buffer,this.buffers[s].byteOffset+o,t);if(t==n)return e.slice();r||(r=n<=Cn?new Uint8Array(n):new Mn(n)),r.set(e,n-a),a-=t,s++,o=0}return r}set(t,e){void 0===e&&(e=0);const n=t.byteLength;if(0==n)return;const i=Math.floor(e/Cn);if(i==Math.floor((e+n-1)/Cn))return t instanceof Mn&&1==t.buffers.length?this.buffers[i].set(t.buffers[0],e%Cn):this.buffers[i].set(t,e%Cn);let r=i,s=e%Cn,o=n;for(;o>0;){const e=s+o>Cn?Cn-s:o,i=t.slice(n-o,n-o+e);new Uint8Array(this.buffers[r].buffer,this.buffers[r].byteOffset+s,e).set(i),o-=e,r++,s=0}}}function Nn(t,e,n,i){return async function(r){const s=Math.floor(r.byteLength/n);if(s*n!==r.byteLength)throw new Error("Invalid buffer size");const o=Math.floor(s/t.concurrency),a=[];for(let c=0;c<t.concurrency;c++){let h;if(h=c<t.concurrency-1?o:s-c*o,0==h)continue;const f=[{cmd:"ALLOCSET",var:0,buff:r.slice(c*o*n,c*o*n+h*n)},{cmd:"ALLOC",var:1,len:i*h},{cmd:"CALL",fnName:e,params:[{var:0},{val:h},{var:1}]},{cmd:"GET",out:0,var:1,len:i*h}];a.push(t.queueAction(f))}const h=await Promise.all(a);let f;f=r instanceof Mn?new Mn(s*i):new Uint8Array(s*i);let u=0;for(let t=0;t<h.length;t++)f.set(h[t][0],u),u+=h[t][0].byteLength;return f}}class Tn{constructor(t,e,n,i){if(this.tm=t,this.prefix=e,this.p=i,this.n8=n,this.type="F1",this.m=1,this.half=pe(i,se),this.bitLength=fe(i),this.mask=_e(le(se,this.bitLength),se),this.pOp1=t.alloc(n),this.pOp2=t.alloc(n),this.pOp3=t.alloc(n),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(n/8),this.n32=Math.floor(n/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=pe(this.p,se),this.nqr=this.two;let r=this.exp(this.nqr,this.half);for(;!this.eq(r,this.negone);)this.nqr=this.add(this.nqr,this.one),r=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let s=_e(this.p,se);for(;!de(s);)this.s=this.s+1,s=pe(s,se);this.w=[],this.w[this.s]=this.exp(this.nqr,s);for(let o=this.s-1;o>=0;o--)this.w[o]=this.square(this.w[o+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Nn(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Nn(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=ie(ae(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let n=ae(t,e);ue(n)?(n=Be(n),Re(n,this.p)&&(n=Se(n,this.p)),n=_e(this.p,n)):Re(n,this.p)&&(n=Se(n,this.p));const i=Sn(n,this.n8);return this.toMontgomery(i)}toString(t,e){const n=this.fromMontgomery(t),i=te(n,0);return ne(i,e)}fromRng(t){let e;const n=new Uint8Array(this.n8);do{e=re;for(let n=0;n<this.n64;n++)e=Le(e,le(t.nextU64(),64*n));e=Ne(e,this.mask)}while(Me(e,this.p));return Xt(n,0,e,this.n8),n}random(){return this.fromRng(Ke())}toObject(t){const e=this.fromMontgomery(t);return te(e,0)}fromObject(t){const e=new Uint8Array(this.n8);return Xt(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,n){t.set(this.fromMontgomery(n),e)}toRprBE(t,e,n){const i=this.fromMontgomery(n);for(let r=0;r<this.n8/2;r++){const t=i[r];i[r]=i[this.n8-1-r],i[this.n8-1-r]=t}t.set(i,e)}fromRprLE(t,e){e=e||0;const n=t.slice(e,e+this.n8);return this.toMontgomery(n)}async batchInverse(t){let e=!1;const n=this.n8,i=this.n8;Array.isArray(t)?(t=xn(t,n),e=!0):t=t.slice(0,t.byteLength);const r=Math.floor(t.byteLength/n);if(r*n!==t.byteLength)throw new Error("Invalid buffer size");const s=Math.floor(r/this.tm.concurrency),o=[];for(let u=0;u<this.tm.concurrency;u++){let e;if(e=u<this.tm.concurrency-1?s:r-u*s,0==e)continue;const a=[{cmd:"ALLOCSET",var:0,buff:t.slice(u*s*n,u*s*n+e*n)},{cmd:"ALLOC",var:1,len:i*e},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:n},{val:e},{var:1},{val:i}]},{cmd:"GET",out:0,var:1,len:i*e}];o.push(this.tm.queueAction(a))}const a=await Promise.all(o);let h;h=t instanceof Mn?new Mn(r*i):new Uint8Array(r*i);let f=0;for(let u=0;u<a.length;u++)h.set(a[u][0],f),f+=a[u][0].byteLength;return e?zn(h,i):h}}class kn{constructor(t,e,n){this.tm=t,this.prefix=e,this.F=n,this.type="F2",this.m=2*n.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*n.n8),this.pOp2=t.alloc(2*n.n8),this.pOp3=t.alloc(2*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=ie(ae(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const n=this.F.e(t[0],e),i=this.F.e(t[1],e),r=new Uint8Array(2*this.F.n8);return r.set(n),r.set(i,2*this.F.n8),r}throw new Error("invalid F2")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),n=this.F.fromRng(t),i=new Uint8Array(2*this.F.n8);return i.set(e),i.set(n,this.F.n8),i}random(){return this.fromRng(Ke())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const e=new Uint8Array(2*this.F.n8),n=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);return e.set(n),e.set(i,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class Gn{constructor(t,e,n){this.tm=t,this.prefix=e,this.F=n,this.type="F3",this.m=3*n.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*n.n8),this.pOp2=t.alloc(3*n.n8),this.pOp3=t.alloc(3*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=ie(ae(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const n=this.F.e(t[0],e),i=this.F.e(t[1],e),r=this.F.e(t[2],e),s=new Uint8Array(3*this.F.n8);return s.set(n),s.set(i,this.F.n8),s.set(r,2*this.F.n8),s}throw new Error("invalid F3")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),n=this.F.fromRng(t),i=this.F.fromRng(t),r=new Uint8Array(3*this.F.n8);return r.set(e),r.set(n,this.F.n8),r.set(i,2*this.F.n8),r}random(){return this.fromRng(Ke())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const e=new Uint8Array(3*this.F.n8),n=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]),r=this.F.fromObject(t[2]);return e.set(n),e.set(i,this.F.n8),e.set(r,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class jn{constructor(t,e,n,i,r,s){this.tm=t,this.prefix=e,this.F=n,this.pOp1=t.alloc(3*n.n8),this.pOp2=t.alloc(3*n.n8),this.pOp3=t.alloc(3*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*n.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*n.n8),this.one=this.tm.getBuff(i,3*n.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(i,2*n.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(r,n.n8),s&&(this.cofactor=ie(s)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Nn(t,e+"_batchLEMtoC",2*n.n8,n.n8),this.batchLEMtoU=Nn(t,e+"_batchLEMtoU",2*n.n8,2*n.n8),this.batchCtoLEM=Nn(t,e+"_batchCtoLEM",n.n8,2*n.n8),this.batchUtoLEM=Nn(t,e+"_batchUtoLEM",2*n.n8,2*n.n8),this.batchToJacobian=Nn(t,e+"_batchToJacobian",2*n.n8,3*n.n8),this.batchToAffine=Nn(t,e+"_batchToAffine",3*n.n8,2*n.n8)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,e){let n;if(e instanceof Uint8Array||(e=ie(ae(e))),t.byteLength==3*this.F.n8)n=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");n=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[n](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let n;if(t.byteLength==3*this.F.n8)n=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");n=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[n](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,e,n){if(this.tm.setBuff(this.pOp1,n),n.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(n.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}fromRprUncompressed(t,e){const n=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,n){if(this.tm.setBuff(this.pOp1,n),n.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(n.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,this.F.n8);t.set(i,e)}fromRprCompressed(t,e){const n=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,n){if(n.byteLength!=2*this.F.n8){if(n.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}}else t.set(n,e)}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)} ]`}if(t.byteLength==2*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)} ]`}throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const e=this.F,n=this.toAffine(t),i=n.slice(0,this.F.n8),r=n.slice(this.F.n8,2*this.F.n8),s=e.add(e.mul(e.square(i),i),this.b),o=e.square(r);return e.eq(s,o)}fromRng(t){const e=this.F;let n,i,r=[];do{r[0]=e.fromRng(t),n=t.nextBool(),i=e.add(e.mul(e.square(r[0]),r[0]),this.b)}while(!e.isSquare(i));r[1]=e.sqrt(i);n^e.isNegative(r[1])&&(r[1]=e.neg(r[1]));let s=new Uint8Array(2*this.F.n8);return s.set(r[0]),s.set(r[1],this.F.n8),this.cofactor&&(s=this.timesScalar(s,this.cofactor)),s}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const e=this.F.toObject(t.slice(0,this.F.n8)),n=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let i;return i=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[e,n,i]}fromObject(t){const e=this.F.fromObject(t[0]),n=this.F.fromObject(t[1]);let i;if(i=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(i,this.F.one))return this.zeroAffine;if(this.F.eq(i,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(e),t.set(n,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(e),t.set(n,this.F.n8),t.set(i,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Pn(t){const e=32767;let n,i;async function r(t){const r=new Uint8Array(t.code),s=await WebAssembly.compile(r);i=new WebAssembly.Memory({initial:t.init,maximum:e}),n=await WebAssembly.instantiate(s,{env:{memory:i}})}function s(t){const n=new Uint32Array(i.buffer,0,1);for(;3&n[0];)n[0]++;const r=n[0];if(n[0]+=t,n[0]+t>i.buffer.byteLength){const r=i.buffer.byteLength/65536;let s=Math.floor((n[0]+t)/65536)+1;s>e&&(s=e),i.grow(s-r)}return r}function o(t){const e=s(t.byteLength);return h(e,t),e}function a(t,e){const n=new Uint8Array(i.buffer);return new Uint8Array(n.buffer,n.byteOffset+t,e)}function h(t,e){new Uint8Array(i.buffer).set(new Uint8Array(e),t)}function f(t){if("INIT"==t[0].cmd)return r(t[0]);const e={vars:[],out:[]},f=new Uint32Array(i.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":e.vars[t[i].var]=o(t[i].buff);break;case"ALLOC":e.vars[t[i].var]=s(t[i].len);break;case"SET":h(e.vars[t[i].var],t[i].buff);break;case"CALL":{const r=[];for(let n=0;n<t[i].params.length;n++){const s=t[i].params[n];"undefined"!==typeof s.var?r.push(e.vars[s.var]+(s.offset||0)):"undefined"!=typeof s.val&&r.push(s.val)}n.exports[t[i].fnName](...r);break}case"GET":e.out[t[i].out]=a(e.vars[t[i].var],t[i].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(i.buffer,0,1)[0]=f,e.out}return t&&(t.onmessage=function(e){let n;if(n=e.data?e.data:e,"INIT"==n[0].cmd)r(n[0]).then((function(){t.postMessage(n.result)}));else if("TERMINATE"==n[0].cmd)t.close();else{const e=f(n);t.postMessage(e)}}),f}var $n=n(6987),Dn=n(4763);class Zn{constructor(){this.promise=new Promise(((t,e)=>{this.reject=e,this.resolve=t}))}}var Wn;const Vn="data:application/javascript;base64,"+(Wn="("+Pn.toString()+")(self)",globalThis.btoa(Wn));class Jn{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,n,i){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=i||new Zn,this.workers[t].postMessage(e,n),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){const n=new Zn;if(this.singleThread){const e=this.taskManager(t);n.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:n}),this.processWorks();return n.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let e=0;e<this.workers.length;e++)this.workers[e].postMessage([{cmd:"TERMINATE"}]);var t;await(t=200,new Promise((e=>setTimeout(e,t))))}}function Hn(t,e){const n=t[e],i=t.Fr,r=t.tm;t[e].batchApplyKey=async function(t,s,o,a,h){let f,u,c,l,p;if(a=a||"affine",h=h||"affine","G1"==e)"jacobian"==a?(c=3*n.F.n8,f="g1m_batchApplyKey"):(c=2*n.F.n8,f="g1m_batchApplyKeyMixed"),l=3*n.F.n8,"jacobian"==h?p=3*n.F.n8:(u="g1m_batchToAffine",p=2*n.F.n8);else if("G2"==e)"jacobian"==a?(c=3*n.F.n8,f="g2m_batchApplyKey"):(c=2*n.F.n8,f="g2m_batchApplyKeyMixed"),l=3*n.F.n8,"jacobian"==h?p=3*n.F.n8:(u="g2m_batchToAffine",p=2*n.F.n8);else{if("Fr"!=e)throw new Error("Invalid group: "+e);f="frm_batchApplyKey",c=n.n8,l=n.n8,p=n.n8}const g=Math.floor(t.byteLength/c),m=Math.floor(g/r.concurrency),d=[];o=i.e(o);let b=i.e(s);for(let e=0;e<r.concurrency;e++){let n;if(n=e<r.concurrency-1?m:g-e*m,0==n)continue;const s=[];s.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*m*c,e*m*c+n*c)}),s.push({cmd:"ALLOCSET",var:1,buff:b}),s.push({cmd:"ALLOCSET",var:2,buff:o}),s.push({cmd:"ALLOC",var:3,len:n*Math.max(l,p)}),s.push({cmd:"CALL",fnName:f,params:[{var:0},{val:n},{var:1},{var:2},{var:3}]}),u&&s.push({cmd:"CALL",fnName:u,params:[{var:3},{val:n},{var:3}]}),s.push({cmd:"GET",out:0,var:3,len:n*p}),d.push(r.queueAction(s)),b=i.mul(b,i.exp(o,n))}const w=await Promise.all(d);let y;y=t instanceof Mn?new Mn(g*p):new Uint8Array(g*p);let v=0;for(let e=0;e<w.length;e++)y.set(w[e][0],v),v+=w[e][0].byteLength;return y}}const Qn=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Kn(t,e){const n=t[e],i=n.tm;async function r(t,i,r,s,o){if(!(t instanceof Uint8Array))throw s&&s.error(`${o} _multiExpChunk buffBases is not Uint8Array`),new Error(`${o} _multiExpChunk buffBases is not Uint8Array`);if(!(i instanceof Uint8Array))throw s&&s.error(`${o} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${o} _multiExpChunk buffScalars is not Uint8Array`);let a,h;if(r=r||"affine","G1"==e)"affine"==r?(h="g1m_multiexpAffine_chunk",a=2*n.F.n8):(h="g1m_multiexp_chunk",a=3*n.F.n8);else{if("G2"!=e)throw new Error("Invalid group");"affine"==r?(h="g2m_multiexpAffine_chunk",a=2*n.F.n8):(h="g2m_multiexp_chunk",a=3*n.F.n8)}const f=Math.floor(t.byteLength/a);if(0==f)return n.zero;const u=Math.floor(i.byteLength/f);if(u*f!=i.byteLength)throw new Error("Scalar size does not match");const c=Qn[Bn(f)],l=Math.floor((8*u-1)/c)+1,p=[];for(let e=0;e<l;e++){const r=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:i},{cmd:"ALLOC",var:2,len:3*n.F.n8},{cmd:"CALL",fnName:h,params:[{var:0},{var:1},{val:u},{val:f},{val:e*c},{val:Math.min(8*u-e*c,c)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*n.F.n8}];p.push(n.tm.queueAction(r))}const g=await Promise.all(p);let m=n.zero;for(let e=g.length-1;e>=0;e--){if(!n.isZero(m))for(let t=0;t<c;t++)m=n.double(m);m=n.add(m,g[e][0])}return m}async function s(t,s,o,a,h){const f=1<<22;let u;if("G1"==e)u="affine"==o?2*n.F.n8:3*n.F.n8;else{if("G2"!=e)throw new Error("Invalid group");u="affine"==o?2*n.F.n8:3*n.F.n8}const c=Math.floor(t.byteLength/u),l=Math.floor(s.byteLength/c);if(l*c!=s.byteLength)throw new Error("Scalar size does not match");const p=Qn[Bn(c)],g=Math.floor((8*l-1)/p)+1;let m;m=Math.floor(c/(i.concurrency/g)),m>f&&(m=f),m<1024&&(m=1024);const d=[];for(let e=0;e<c;e+=m){a&&a.debug(`Multiexp start: ${h}: ${e}/${c}`);const n=Math.min(c-e,m),i=t.slice(e*u,(e+n)*u),f=s.slice(e*l,(e+n)*l);d.push(r(i,f,o,a,h).then((t=>(a&&a.debug(`Multiexp end: ${h}: ${e}/${c}`),t))))}const b=await Promise.all(d);let w=n.zero;for(let e=b.length-1;e>=0;e--)w=n.add(w,b[e]);return w}n.multiExp=async function(t,e,n,i){return await s(t,e,"jacobian",n,i)},n.multiExpAffine=async function(t,e,n,i){return await s(t,e,"affine",n,i)}}function Xn(t,e){const n=t[e],i=t.Fr,r=n.tm;async function s(t,a,h,f,u,c){h=h||"affine",f=f||"affine";let l,p,g,m,d,b,w,y;"G1"==e?("affine"==h?(l=2*n.F.n8,m="g1m_batchToJacobian"):l=3*n.F.n8,p=3*n.F.n8,a&&(y="g1m_fftFinal"),w="g1m_fftJoin",b="g1m_fftMix","affine"==f?(g=2*n.F.n8,d="g1m_batchToAffine"):g=3*n.F.n8):"G2"==e?("affine"==h?(l=2*n.F.n8,m="g2m_batchToJacobian"):l=3*n.F.n8,p=3*n.F.n8,a&&(y="g2m_fftFinal"),w="g2m_fftJoin",b="g2m_fftMix","affine"==f?(g=2*n.F.n8,d="g2m_batchToAffine"):g=3*n.F.n8):"Fr"==e&&(l=n.n8,p=n.n8,g=n.n8,a&&(y="frm_fftFinal"),b="frm_fftMix",w="frm_fftJoin");let v=!1;Array.isArray(t)?(t=xn(t,l),v=!0):t=t.slice(0,t.byteLength);const L=t.byteLength/l,_=Bn(L);if(1<<_!=L)throw new Error("fft must be multiple of 2");if(_==i.s+1){let e;return e=a?await async function(t,e,n,r,a){let h,f;h=t.slice(0,t.byteLength/2),f=t.slice(t.byteLength/2,t.byteLength);const u=[];u.push(s(h,!0,e,"jacobian",r,a)),u.push(s(f,!0,e,"jacobian",r,a)),[h,f]=await Promise.all(u);const c=await o(h,f,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",n,r,a);let l;l=c[0].byteLength>1<<28?new Mn(2*c[0].byteLength):new Uint8Array(2*c[0].byteLength);return l.set(c[0]),l.set(c[1],c[0].byteLength),l}(t,h,f,u,c):await async function(t,e,n,r,a){let h,f;h=t.slice(0,t.byteLength/2),f=t.slice(t.byteLength/2,t.byteLength);const u=[];[h,f]=await o(h,f,"fftJoinExt",i.one,i.shift,e,"jacobian",r,a),u.push(s(h,!1,"jacobian",n,r,a)),u.push(s(f,!1,"jacobian",n,r,a));const c=await Promise.all(u);let l;l=c[0].byteLength>1<<28?new Mn(2*c[0].byteLength):new Uint8Array(2*c[0].byteLength);return l.set(c[0]),l.set(c[1],c[0].byteLength),l}(t,h,f,u,c),v?zn(e,g):e}let B,E,A;a&&(B=i.inv(i.e(L))),En(t,l);let F=Math.min(16384,L),I=L/F;for(;I<r.concurrency&&F>=16;)I*=2,F/=2;const O=Bn(F),q=[];for(let e=0;e<I;e++){u&&u.debug(`${c}: fft ${_} mix start: ${e}/${I}`);const n=[];n.push({cmd:"ALLOC",var:0,len:p*F});const i=t.slice(F*e*l,F*(e+1)*l);n.push({cmd:"SET",var:0,buff:i}),m&&n.push({cmd:"CALL",fnName:m,params:[{var:0},{val:F},{var:0}]});for(let t=1;t<=O;t++)n.push({cmd:"CALL",fnName:b,params:[{var:0},{val:F},{val:t}]});O==_?(y&&(n.push({cmd:"ALLOCSET",var:1,buff:B}),n.push({cmd:"CALL",fnName:y,params:[{var:0},{val:F},{var:1}]})),d&&n.push({cmd:"CALL",fnName:d,params:[{var:0},{val:F},{var:0}]}),n.push({cmd:"GET",out:0,var:0,len:F*g})):n.push({cmd:"GET",out:0,var:0,len:p*F}),q.push(r.queueAction(n).then((t=>(u&&u.debug(`${c}: fft ${_} mix end: ${e}/${I}`),t))))}A=await Promise.all(q);for(let e=0;e<I;e++)A[e]=A[e][0];for(let e=O+1;e<=_;e++){u&&u.debug(`${c}: fft  ${_}  join: ${e}/${_}`);const t=1<<_-e,n=I/t,s=[];for(let a=0;a<t;a++)for(let o=0;o<n/2;o++){const h=i.exp(i.w[e],o*F),f=i.w[e],l=a*n+o,m=a*n+o+n/2,b=[];b.push({cmd:"ALLOCSET",var:0,buff:A[l]}),b.push({cmd:"ALLOCSET",var:1,buff:A[m]}),b.push({cmd:"ALLOCSET",var:2,buff:h}),b.push({cmd:"ALLOCSET",var:3,buff:f}),b.push({cmd:"CALL",fnName:w,params:[{var:0},{var:1},{val:F},{var:2},{var:3}]}),e==_?(y&&(b.push({cmd:"ALLOCSET",var:4,buff:B}),b.push({cmd:"CALL",fnName:y,params:[{var:0},{val:F},{var:4}]}),b.push({cmd:"CALL",fnName:y,params:[{var:1},{val:F},{var:4}]})),d&&(b.push({cmd:"CALL",fnName:d,params:[{var:0},{val:F},{var:0}]}),b.push({cmd:"CALL",fnName:d,params:[{var:1},{val:F},{var:1}]})),b.push({cmd:"GET",out:0,var:0,len:F*g}),b.push({cmd:"GET",out:1,var:1,len:F*g})):(b.push({cmd:"GET",out:0,var:0,len:F*p}),b.push({cmd:"GET",out:1,var:1,len:F*p})),s.push(r.queueAction(b).then((i=>(u&&u.debug(`${c}: fft ${_} join  ${e}/${_}  ${a+1}/${t} ${o}/${n/2}`),i))))}const o=await Promise.all(s);for(let e=0;e<t;e++)for(let t=0;t<n/2;t++){const i=e*n+t,r=e*n+t+n/2,s=o.shift();A[i]=s[0],A[r]=s[1]}}if(E=t instanceof Mn?new Mn(L*g):new Uint8Array(L*g),a){E.set(A[0].slice((F-1)*g));let t=g;for(let e=I-1;e>0;e--)E.set(A[e],t),t+=F*g,delete A[e];E.set(A[0].slice(0,(F-1)*g),t),delete A[0]}else for(let e=0;e<I;e++)E.set(A[e],F*g*e),delete A[e];return v?zn(E,g):E}async function o(t,s,o,a,h,f,u,c,l){let p,g,m,d,b,w;if("G1"==e)"affine"==f?(b=2*n.F.n8,g="g1m_batchToJacobian"):b=3*n.F.n8,w=3*n.F.n8,p="g1m_"+o,"affine"==u?(m="g1m_batchToAffine",d=2*n.F.n8):d=3*n.F.n8;else if("G2"==e)"affine"==f?(b=2*n.F.n8,g="g2m_batchToJacobian"):b=3*n.F.n8,p="g2m_"+o,w=3*n.F.n8,"affine"==u?(m="g2m_batchToAffine",d=2*n.F.n8):d=3*n.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");b=i.n8,d=i.n8,w=i.n8,p="frm_"+o}if(t.byteLength!=s.byteLength)throw new Error("Invalid buffer size");const y=Math.floor(t.byteLength/b);if(y!=1<<Bn(y))throw new Error("Invalid number of points");let v=Math.floor(y/r.concurrency);v<16&&(v=16),v>65536&&(v=65536);const L=[];for(let e=0;e<y;e+=v){c&&c.debug(`${l}: fftJoinExt Start: ${e}/${y}`);const n=Math.min(y-e,v),o=i.mul(a,i.exp(h,e)),f=[],u=t.slice(e*b,(e+n)*b),_=s.slice(e*b,(e+n)*b);f.push({cmd:"ALLOC",var:0,len:w*n}),f.push({cmd:"SET",var:0,buff:u}),f.push({cmd:"ALLOC",var:1,len:w*n}),f.push({cmd:"SET",var:1,buff:_}),f.push({cmd:"ALLOCSET",var:2,buff:o}),f.push({cmd:"ALLOCSET",var:3,buff:h}),g&&(f.push({cmd:"CALL",fnName:g,params:[{var:0},{val:n},{var:0}]}),f.push({cmd:"CALL",fnName:g,params:[{var:1},{val:n},{var:1}]})),f.push({cmd:"CALL",fnName:p,params:[{var:0},{var:1},{val:n},{var:2},{var:3},{val:i.s}]}),m&&(f.push({cmd:"CALL",fnName:m,params:[{var:0},{val:n},{var:0}]}),f.push({cmd:"CALL",fnName:m,params:[{var:1},{val:n},{var:1}]})),f.push({cmd:"GET",out:0,var:0,len:n*d}),f.push({cmd:"GET",out:1,var:1,len:n*d}),L.push(r.queueAction(f).then((t=>(c&&c.debug(`${l}: fftJoinExt End: ${e}/${y}`),t))))}const _=await Promise.all(L);let B,E;y*d>1<<28?(B=new Mn(y*d),E=new Mn(y*d)):(B=new Uint8Array(y*d),E=new Uint8Array(y*d));let A=0;for(let e=0;e<_.length;e++)B.set(_[e][0],A),E.set(_[e][1],A),A+=_[e][0].byteLength;return[B,E]}n.fft=async function(t,e,n,i,r){return await s(t,!1,e,n,i,r)},n.ifft=async function(t,e,n,i,r){return await s(t,!0,e,n,i,r)},n.lagrangeEvaluations=async function(t,r,a,h,f){let u;if(r=r||"affine",a=a||"affine","G1"==e)u="affine"==r?2*n.F.n8:3*n.F.n8;else if("G2"==e)u="affine"==r?2*n.F.n8:3*n.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");u=i.n8}const c=t.byteLength/u,l=Bn(c);if(2**l*u!=t.byteLength)throw h&&h.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(l<=i.s)return await n.ifft(t,r,a,h,f);if(l>i.s+1)throw h&&h.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let p=t.slice(0,t.byteLength/2),g=t.slice(t.byteLength/2,t.byteLength);const m=i.exp(i.shift,c/2),d=i.inv(i.sub(i.one,m));[p,g]=await o(p,g,"prepareLagrangeEvaluation",d,i.shiftInv,r,"jacobian",h,f+" prep");const b=[];let w;return b.push(s(p,!0,"jacobian",a,h,f+" t0")),b.push(s(g,!0,"jacobian",a,h,f+" t1")),[p,g]=await Promise.all(b),w=p.byteLength>1<<28?new Mn(2*p.byteLength):new Uint8Array(2*p.byteLength),w.set(p),w.set(g,p.byteLength),w},n.fftMix=async function(t){const s=3*n.F.n8;let o,a;if("G1"==e)o="g1m_fftMix",a="g1m_fftJoin";else if("G2"==e)o="g2m_fftMix",a="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");o="frm_fftMix",a="frm_fftJoin"}const h=Math.floor(t.byteLength/s),f=Bn(h);let u=1<<Bn(r.concurrency);h<=2*u&&(u=1);const c=h/u,l=Bn(c),p=[];for(let e=0;e<u;e++){const n=[],i=t.slice(e*c*s,(e+1)*c*s);n.push({cmd:"ALLOCSET",var:0,buff:i});for(let t=1;t<=l;t++)n.push({cmd:"CALL",fnName:o,params:[{var:0},{val:c},{val:t}]});n.push({cmd:"GET",out:0,var:0,len:c*s}),p.push(r.queueAction(n))}const g=await Promise.all(p),m=[];for(let e=0;e<g.length;e++)m[e]=g[e][0];for(let e=l+1;e<=f;e++){const t=1<<f-e,n=u/t,o=[];for(let f=0;f<t;f++)for(let t=0;t<n/2;t++){const h=i.exp(i.w[e],t*c),u=i.w[e],l=f*n+t,p=f*n+t+n/2,g=[];g.push({cmd:"ALLOCSET",var:0,buff:m[l]}),g.push({cmd:"ALLOCSET",var:1,buff:m[p]}),g.push({cmd:"ALLOCSET",var:2,buff:h}),g.push({cmd:"ALLOCSET",var:3,buff:u}),g.push({cmd:"CALL",fnName:a,params:[{var:0},{var:1},{val:c},{var:2},{var:3}]}),g.push({cmd:"GET",out:0,var:0,len:c*s}),g.push({cmd:"GET",out:1,var:1,len:c*s}),o.push(r.queueAction(g))}const h=await Promise.all(o);for(let e=0;e<t;e++)for(let t=0;t<n/2;t++){const i=e*n+t,r=e*n+t+n/2,s=h.shift();m[i]=s[0],m[r]=s[1]}}let d;d=t instanceof Mn?new Mn(h*s):new Uint8Array(h*s);let b=0;for(let e=0;e<u;e++)d.set(m[e],b),b+=m[e].byteLength;return d},n.fftJoin=async function(t,s,o,a){const h=3*n.F.n8;let f;if("G1"==e)f="g1m_fftJoin";else if("G2"==e)f="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");f="frm_fftJoin"}if(t.byteLength!=s.byteLength)throw new Error("Invalid buffer size");const u=Math.floor(t.byteLength/h);if(u!=1<<Bn(u))throw new Error("Invalid number of points");let c=1<<Bn(r.concurrency);u<=2*c&&(c=1);const l=u/c,p=[];for(let e=0;e<c;e++){const n=[],u=i.mul(o,i.exp(a,e*l)),c=t.slice(e*l*h,(e+1)*l*h),g=s.slice(e*l*h,(e+1)*l*h);n.push({cmd:"ALLOCSET",var:0,buff:c}),n.push({cmd:"ALLOCSET",var:1,buff:g}),n.push({cmd:"ALLOCSET",var:2,buff:u}),n.push({cmd:"ALLOCSET",var:3,buff:a}),n.push({cmd:"CALL",fnName:f,params:[{var:0},{var:1},{val:l},{var:2},{var:3}]}),n.push({cmd:"GET",out:0,var:0,len:l*h}),n.push({cmd:"GET",out:1,var:1,len:l*h}),p.push(r.queueAction(n))}const g=await Promise.all(p);let m,d;t instanceof Mn?(m=new Mn(u*h),d=new Mn(u*h)):(m=new Uint8Array(u*h),d=new Uint8Array(u*h));let b=0;for(let e=0;e<g.length;e++)m.set(g[e][0],b),d.set(g[e][1],b),b+=g[e][0].byteLength;return[m,d]},n.fftFinal=async function(t,i){const s=3*n.F.n8,o=2*n.F.n8;let a,h;if("G1"==e)a="g1m_fftFinal",h="g1m_batchToAffine";else{if("G2"!=e)throw new Error("Invalid group");a="g2m_fftFinal",h="g2m_batchToAffine"}const f=Math.floor(t.byteLength/s);if(f!=1<<Bn(f))throw new Error("Invalid number of points");const u=Math.floor(f/r.concurrency),c=[];for(let e=0;e<r.concurrency;e++){let n;if(n=e<r.concurrency-1?u:f-e*u,0==n)continue;const l=[],p=t.slice(e*u*s,(e*u+n)*s);l.push({cmd:"ALLOCSET",var:0,buff:p}),l.push({cmd:"ALLOCSET",var:1,buff:i}),l.push({cmd:"CALL",fnName:a,params:[{var:0},{val:n},{var:1}]}),l.push({cmd:"CALL",fnName:h,params:[{var:0},{val:n},{var:0}]}),l.push({cmd:"GET",out:0,var:0,len:n*o}),c.push(r.queueAction(l))}const l=await Promise.all(c);let p;p=t instanceof Mn?new Mn(f*o):new Uint8Array(f*o);let g=0;for(let e=l.length-1;e>=0;e--)p.set(l[e][0],g),g+=l[e][0].byteLength;return p}}async function Yn(t){const e=await async function(t,e){const n=new Jn;n.memory=new WebAssembly.Memory({initial:25}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);const i=await WebAssembly.compile(t.code);if(n.instance=await WebAssembly.instantiate(i,{env:{memory:n.memory}}),n.singleThread=e,n.initalPFree=n.u32[0],n.pq=t.pq,n.pr=t.pr,n.pG1gen=t.pG1gen,n.pG1zero=t.pG1zero,n.pG2gen=t.pG2gen,n.pG2zero=t.pG2zero,n.pOneT=t.pOneT,e)n.code=t.code,n.taskManager=Pn(),await n.taskManager([{cmd:"INIT",init:25,code:n.code.slice()}]),n.concurrency=1;else{let e;n.workers=[],n.pendingDeferreds=[],n.working=[],e="object"===typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:$n.cpus().length,0==e&&(e=2),e>64&&(e=64),n.concurrency=e;for(let t=0;t<e;t++)n.workers[t]=new Dn(Vn),n.workers[t].addEventListener("message",r(t)),n.working[t]=!1;const i=[];for(let r=0;r<n.workers.length;r++){const e=t.code.slice();i.push(n.postAction(r,[{cmd:"INIT",init:25,code:e}],[e.buffer]))}await Promise.all(i)}return n;function r(t){return function(e){let i;i=e&&e.data?e.data:e,n.working[t]=!1,n.pendingDeferreds[t].resolve(i),n.processWorks()}}}(t.wasm,t.singleThread),n={};return n.q=ae(t.wasm.q),n.r=ae(t.wasm.r),n.name=t.name,n.tm=e,n.prePSize=t.wasm.prePSize,n.preQSize=t.wasm.preQSize,n.Fr=new Tn(e,"frm",t.n8r,t.r),n.F1=new Tn(e,"f1m",t.n8q,t.q),n.F2=new kn(e,"f2m",n.F1),n.G1=new jn(e,"g1m",n.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),n.G2=new jn(e,"g2m",n.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),n.F6=new Gn(e,"f6m",n.F2),n.F12=new kn(e,"ftm",n.F6),n.Gt=n.F12,Hn(n,"G1"),Hn(n,"G2"),Hn(n,"Fr"),Kn(n,"G1"),Kn(n,"G2"),Xn(n,"G1"),Xn(n,"G2"),Xn(n,"Fr"),function(t){const e=t.tm;t.pairing=function(n,i){e.startSyncOp();const r=e.allocBuff(t.G1.toJacobian(n)),s=e.allocBuff(t.G2.toJacobian(i)),o=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](r,s,o);const a=e.getBuff(o,t.Gt.n8);return e.endSyncOp(),a},t.pairingEq=async function(){let n,i;arguments.length%2==1?(n=arguments[arguments.length-1],i=(arguments.length-1)/2):(n=t.Gt.one,i=arguments.length/2);const r=[];for(let f=0;f<i;f++){const n=[],i=t.G1.toJacobian(arguments[2*f]);n.push({cmd:"ALLOCSET",var:0,buff:i}),n.push({cmd:"ALLOC",var:1,len:t.prePSize});const s=t.G2.toJacobian(arguments[2*f+1]);n.push({cmd:"ALLOCSET",var:2,buff:s}),n.push({cmd:"ALLOC",var:3,len:t.preQSize}),n.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),n.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),n.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),n.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),n.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),r.push(e.queueAction(n))}const s=await Promise.all(r);e.startSyncOp();const o=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(o);for(let t=0;t<s.length;t++){const n=e.allocBuff(s[t][0]);e.instance.exports.ftm_mul(o,n,o)}e.instance.exports[t.name+"_finalExponentiation"](o,o);const a=e.allocBuff(n),h=!!e.instance.exports.ftm_eq(o,a);return e.endSyncOp(),h},t.prepareG1=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),n=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,n);const i=this.tm.getBuff(n,this.prePSize);return this.tm.endSyncOp(),i},t.prepareG2=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),n=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,n);const i=this.tm.getBuff(n,this.preQSize);return this.tm.endSyncOp(),i},t.millerLoop=function(t,e){this.tm.startSyncOp();const n=this.tm.allocBuff(t),i=this.tm.allocBuff(e),r=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](n,i,r);const s=this.tm.getBuff(r,this.Gt.n8);return this.tm.endSyncOp(),s},t.finalExponentiation=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),n=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,n);const i=this.tm.getBuff(n,this.Gt.n8);return this.tm.endSyncOp(),i}}(n),n.array2buffer=function(t,e){const n=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)n.set(t[i],i*e);return n},n.buffer2array=function(t,e){const n=t.byteLength/e,i=new Array(n);for(let r=0;r<n;r++)i[r]=t.slice(r*e,r*e+e);return i},n}var ti=n(4659);async function ei(t,e){const n=new ti.ModuleBuilder;n.setMemory(25),(0,rn.buildBn128)(n),e&&e(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bn128.pG1gen,i.pG1zero=n.modules.bn128.pG1zero,i.pG1b=n.modules.bn128.pG1b,i.pG2gen=n.modules.bn128.pG2gen,i.pG2zero=n.modules.bn128.pG2zero,i.pG2b=n.modules.bn128.pG2b,i.pOneT=n.modules.bn128.pOneT,i.prePSize=n.modules.bn128.prePSize,i.preQSize=n.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=n.modules.bn128.q,i.r=n.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const r={name:"bn128",wasm:i,q:ae("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:ae("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:ae("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},s=await Yn(r);return s.terminate=async function(){r.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=s),s}async function ni(t,e){const n=new ti.ModuleBuilder;n.setMemory(25),(0,rn.buildBls12381)(n),e&&e(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bls12381.pG1gen,i.pG1zero=n.modules.bls12381.pG1zero,i.pG1b=n.modules.bls12381.pG1b,i.pG2gen=n.modules.bls12381.pG2gen,i.pG2zero=n.modules.bls12381.pG2zero,i.pG2b=n.modules.bls12381.pG2b,i.pOneT=n.modules.bls12381.pOneT,i.prePSize=n.modules.bls12381.prePSize,i.preQSize=n.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=n.modules.bn128.q,i.r=n.modules.bn128.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const r={name:"bls12381",wasm:i,q:ae("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:ae("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:ae("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:ae("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},s=await Yn(r);return s.terminate=async function(){r.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=s),s}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;ae("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ae("21888242871839275222246405745257275088548364400416034343698204186575808495617"),ae("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ae("21888242871839275222246405745257275088696311157297823662689037894645226208583");const ii=s,ri=h;var si=n(6574);async function oi(t,e,n,i){if(n=n||262144,["w+","wx+","r","ax+","a+"].indexOf(e)<0)throw new Error("Invalid open option");const r=await si.promises.open(t,e),s=await r.stat();return new ai(r,s,n,i,t)}class ai{constructor(t,e,n,i,r){for(this.fileName=r,this.fd=t,this.pos=0,this.pageSize=i||256;this.pageSize<e.blksize;)this.pageSize*=2;this.totalSize=e.size,this.totalPages=Math.floor((e.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(n/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const e=this,n=new Promise(((n,i)=>{e.pendingLoads.push({page:t,resolve:n,reject:i})}));return e.__statusPage("After Load request: ",t),n}__statusPage(t,e){const n=[],i=this;if(!i.logHistory)return;n.push("=="+t+" "+e);let r="";for(let s=0;s<i.pendingLoads.length;s++)i.pendingLoads[s].page==e&&(r=r+" "+s);if(r&&n.push("Pending loads:"+r),"undefined"!=typeof i.pages[e]){const t=i.pages[e];n.push("Loaded"),n.push("pendingOps: "+t.pendingOps),t.loading&&n.push("loading: "+t.loading),t.writing&&n.push("writing"),t.dirty&&n.push("dirty")}n.push("=="),i.history[e]||(i.history[e]=[]),i.history[e].push(n)}__printHistory(t){const e=this;e.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let n=0;n<e.history[t].length;n++)for(let i=0;i<e.history[t][n].length;i++)console.log("-> "+e.history[t][n][i])}_triggerLoad(){const t=this;if(t.reading)return;if(0==t.pendingLoads.length)return;const e=Object.keys(t.pages),n=[];for(let o=0;o<e.length;o++){const i=t.pages[parseInt(e[o])];0!=i.dirty||0!=i.pendingOps||i.writing||i.loading||n.push(parseInt(e[o]))}let i=t.maxPagesLoaded-e.length;const r=[];for(;t.pendingLoads.length>0&&("undefined"!=typeof t.pages[t.pendingLoads[0].page]||i>0||n.length>0);){const e=t.pendingLoads.shift();if("undefined"!=typeof t.pages[e.page]){t.pages[e.page].pendingOps++;const i=n.indexOf(e.page);i>=0&&n.splice(i,1),t.pages[e.page].loading?t.pages[e.page].loading.push(e):e.resolve(),t.__statusPage("After Load (cached): ",e.page)}else{if(i)i--;else{const e=n.shift();t.__statusPage("Before Unload: ",e),t.avBuffs.unshift(t.pages[e]),delete t.pages[e],t.__statusPage("After Unload: ",e)}e.page>=t.totalPages?(t.pages[e.page]=s(),e.resolve(),t.__statusPage("After Load (new): ",e.page)):(t.reading=!0,t.pages[e.page]=s(),t.pages[e.page].loading=[e],r.push(t.fd.read(t.pages[e.page].buff,0,t.pageSize,e.page*t.pageSize).then((n=>{t.pages[e.page].size=n.bytesRead;const i=t.pages[e.page].loading;delete t.pages[e.page].loading;for(let t=0;t<i.length;t++)i[t].resolve();return t.__statusPage("After Load (loaded): ",e.page),n}),(t=>{e.reject(t)}))),t.__statusPage("After Load (loading): ",e.page))}}function s(){if(t.avBuffs.length>0){const e=t.avBuffs.shift();return e.dirty=!1,e.pendingOps=1,e.size=0,e}return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}Promise.all(r).then((()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()}))}_triggerWrite(){const t=this;if(t.writing)return;const e=Object.keys(t.pages),n=[];for(let i=0;i<e.length;i++){const r=t.pages[parseInt(e[i])];r.dirty&&(r.dirty=!1,r.writing=!0,t.writing=!0,n.push(t.fd.write(r.buff,0,r.size,parseInt(e[i])*t.pageSize).then((()=>{r.writing=!1}),(e=>{console.log("ERROR Writing: "+e),t.error=e,t._tryClose()}))))}t.writing&&Promise.all(n).then((()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))}))}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,e){if(0==t.byteLength)return;const n=this;if("undefined"==typeof e&&(e=n.pos),n.pos=e+t.byteLength,n.totalSize<e+t.byteLength&&(n.totalSize=e+t.byteLength),n.pendingClose)throw new Error("Writing a closing file");const i=Math.floor(e/n.pageSize),r=Math.floor((e+t.byteLength-1)/n.pageSize),s=[];for(let f=i;f<=r;f++)s.push(n._loadPage(f));n._triggerLoad();let o=i,a=e%n.pageSize,h=t.byteLength;for(;h>0;){await s[o-i];const e=a+h>n.pageSize?n.pageSize-a:h,r=t.slice(t.byteLength-h,t.byteLength-h+e);new Uint8Array(n.pages[o].buff.buffer,a,e).set(r),n.pages[o].dirty=!0,n.pages[o].pendingOps--,n.pages[o].size=Math.max(a+e,n.pages[o].size),o>=n.totalPages&&(n.totalPages=o+1),h-=e,o++,a=0,n.writing||setImmediate(n._triggerWrite.bind(n))}}async read(t,e){let n=new Uint8Array(t);return await this.readToBuffer(n,0,t,e),n}async readToBuffer(t,e,n,i){if(0==n)return;const r=this;if(n>r.pageSize*r.maxPagesLoaded*.8){const t=Math.floor(1.1*n);this.maxPagesLoaded=Math.floor(t/r.pageSize)+1}if("undefined"==typeof i&&(i=r.pos),r.pos=i+n,r.pendingClose)throw new Error("Reading a closing file");const s=Math.floor(i/r.pageSize),o=Math.floor((i+n-1)/r.pageSize),a=[];for(let c=s;c<=o;c++)a.push(r._loadPage(c));r._triggerLoad();let h=s,f=i%r.pageSize,u=i+n>r.totalSize?n-(i+n-r.totalSize):n;for(;u>0;){await a[h-s],r.__statusPage("After Await (read): ",h);const i=f+u>r.pageSize?r.pageSize-f:u,o=new Uint8Array(r.pages[h].buff.buffer,r.pages[h].buff.byteOffset+f,i);t.set(o,e+n-u),r.pages[h].pendingOps--,r.__statusPage("After Op done: ",h),u-=i,h++,f=0,r.pendingLoads.length>0&&setImmediate(r._triggerLoad.bind(r))}this.pos=i+n}_tryClose(){const t=this;if(!t.pendingClose)return;t.error&&t.pendingCloseReject(t.error);t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise(((e,n)=>{t.pendingClose=e,t.pendingCloseReject=n,t._tryClose()})).then((()=>{t.fd.close()}),(e=>{throw t.fd.close(),e}))}async discard(){await this.close(),await si.promises.unlink(this.fileName)}async writeULE32(t,e){const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t,!0),await this.write(n,e)}async writeUBE32(t,e){const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t,!1),await this.write(n,e)}async writeULE64(t,e){const n=new Uint8Array(8),i=new DataView(n.buffer);i.setUint32(0,4294967295&t,!0),i.setUint32(4,Math.floor(t/4294967296),!0),await this.write(n,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),n=new Uint32Array(e.buffer);return 4294967296*n[1]+n[0]}}const hi=new Uint8Array(4),fi=new DataView(hi.buffer),ui=new Uint8Array(8),ci=new DataView(ui.buffer);class li{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const e=Math.max(this.allocSize+(1<<20),Math.floor(1.1*this.allocSize),t),n=new Uint8Array(e);n.set(this.o.data),this.o.data=n,this.allocSize=e}}async write(t,e){if("undefined"==typeof e&&(e=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength),this.o.data.set(t.slice(),e),e+t.byteLength>this.totalSize&&(this.totalSize=e+t.byteLength),this.pos=e+t.byteLength}async readToBuffer(t,e,n,i){if("undefined"==typeof i&&(i=this.pos),this.readOnly&&i+n>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+n);const r=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+i,n);t.set(r,e),this.pos=i+n}async read(t,e){const n=new Uint8Array(t);return await this.readToBuffer(n,0,t,e),n}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,e){fi.setUint32(0,t,!0),await this.write(hi,e)}async writeUBE32(t,e){fi.setUint32(0,t,!1),await this.write(hi,e)}async writeULE64(t,e){ci.setUint32(0,4294967295&t,!0),ci.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ui,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),n=new Uint32Array(e.buffer);return 4294967296*n[1]+n[0]}}const pi=1<<22;const gi=new Uint8Array(4),mi=new DataView(gi.buffer),di=new Uint8Array(8),bi=new DataView(di.buffer);class wi{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const e=Math.floor((t-1)/pi)+1;for(let n=Math.max(this.o.data.length-1,0);n<e;n++){const i=new Uint8Array(n<e-1?pi:t-(e-1)*pi);n==this.o.data.length-1&&i.set(this.o.data[n]),this.o.data[n]=i}this.totalSize=t}async write(t,e){const n=this;if("undefined"==typeof e&&(e=n.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength);let i=Math.floor(e/pi),r=e%pi,s=t.byteLength;for(;s>0;){const e=r+s>pi?pi-r:s,o=t.slice(t.byteLength-s,t.byteLength-s+e);new Uint8Array(n.o.data[i].buffer,r,e).set(o),s-=e,i++,r=0}this.pos=e+t.byteLength}async readToBuffer(t,e,n,i){const r=this;if("undefined"==typeof i&&(i=r.pos),this.readOnly&&i+n>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+n);let s=Math.floor(i/pi),o=i%pi,a=n;for(;a>0;){const i=o+a>pi?pi-o:a,h=new Uint8Array(r.o.data[s].buffer,o,i);t.set(h,e+n-a),a-=i,s++,o=0}this.pos=i+n}async read(t,e){const n=new Uint8Array(t);return await this.readToBuffer(n,0,t,e),n}close(){}async discard(){}async writeULE32(t,e){mi.setUint32(0,t,!0),await this.write(gi,e)}async writeUBE32(t,e){mi.setUint32(0,t,!1),await this.write(gi,e)}async writeULE64(t,e){bi.setUint32(0,4294967295&t,!0),bi.setUint32(4,Math.floor(t/4294967296),!0),await this.write(di,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),n=new Uint32Array(e.buffer);return 4294967296*n[1]+n[0]}}const yi=65536,vi=8192;async function Li(t,e,n){if("string"===typeof t&&(t={type:"file",fileName:t,cacheSize:e||yi,pageSize:n||vi}),"file"==t.type)return await oi(t.fileName,"w+",t.cacheSize,t.pageSize);if("mem"==t.type)return function(t){const e=t.initialSize||1<<20,n=new li;return n.o=t,n.o.data=new Uint8Array(e),n.allocSize=e,n.totalSize=0,n.readOnly=!1,n.pos=0,n}(t);if("bigMem"==t.type)return function(t){const e=t.initialSize||0,n=new wi;n.o=t;const i=e?Math.floor((e-1)/pi)+1:0;n.o.data=[];for(let r=0;r<i-1;r++)n.o.data.push(new Uint8Array(pi));return i&&n.o.data.push(new Uint8Array(e-pi*(i-1))),n.totalSize=0,n.readOnly=!1,n.pos=0,n}(t);throw new Error("Invalid FastFile type: "+t.type)}async function _i(t,e,n){if(t instanceof Uint8Array&&(t={type:"mem",data:t}),"string"===typeof t){t={type:"mem",data:await fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return new Uint8Array(t)}))}}if("file"==t.type)return await oi(t.fileName,"r",t.cacheSize,t.pageSize);if("mem"==t.type)return await function(t){const e=new li;return e.o=t,e.allocSize=t.data.byteLength,e.totalSize=t.data.byteLength,e.readOnly=!0,e.pos=0,e}(t);if("bigMem"==t.type)return await function(t){const e=new wi;return e.o=t,e.totalSize=(t.data.length-1)*pi+t.data[t.data.length-1].byteLength,e.readOnly=!0,e.pos=0,e}(t);throw new Error("Invalid FastFile type: "+t.type)}async function Bi(t,e,n,i,r){const s=await _i(t),o=await s.read(4);let a="";for(let u=0;u<4;u++)a+=String.fromCharCode(o[u]);if(a!=e)throw new Error(t+": Invalid File format");if(await s.readULE32()>n)throw new Error("Version not supported");const h=await s.readULE32();let f=[];for(let u=0;u<h;u++){let t=await s.readULE32(),e=await s.readULE64();"undefined"==typeof f[t]&&(f[t]=[]),f[t].push({p:s.pos,size:e}),s.pos+=e}return{fd:s,sections:f}}async function Ei(t,e){if("undefined"!==typeof t.writingSection)throw new Error("Already writing a section");await t.writeULE32(e),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function Ai(t){if("undefined"===typeof t.writingSection)throw new Error("Not writing a section");const e=t.pos-t.writingSection.pSectionSize-8,n=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(e),t.pos=n,delete t.writingSection}async function Fi(t,e,n){if("undefined"!==typeof t.readingSection)throw new Error("Already reading a section");if(!e[n])throw new Error(t.fileName+": Missing section "+n);if(e[n].length>1)throw new Error(t.fileName+": Section Duplicated "+n);t.pos=e[n][0].p,t.readingSection=e[n][0]}async function Ii(t,e){if("undefined"===typeof t.readingSection)throw new Error("Not reading a section");if(!e&&t.pos-t.readingSection.p!=t.readingSection.size)throw new Error("Invalid section size reading");delete t.readingSection}async function Oi(t,e,n){const i=await t.read(e,n);return ii.fromRprLE(i,0,e)}async function qi(t,e,n,i,r){if((i="undefined"===typeof i?0:i)+(r="undefined"===typeof r?e[n][0].size-i:r)>e[n][0].size)throw new Error("Reading out of the range of the section");let s;return s=r<1<<30?new Uint8Array(r):new Mn(r),await t.readToBuffer(s,0,r,e[n][0].p+i),s}ii.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ii.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const Si=ii.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),xi=ii.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function zi(t){let e;if(ii.eq(t,xi))e=await ei();else{if(!ii.eq(t,Si))throw new Error(`Curve not supported: ${ii.toString(t)}`);e=await ni()}return e}n(7060),n(3544),n(9103),n(8764).Buffer;const Ui=[];for(let ca=0;ca<256;ca++)Ui[ca]=Ri(ca,8);function Ri(t,e){let n=0,i=t;for(let r=0;r<e;r++)n<<=1,n|=1&i,i>>=1;return n}function Ci(t){return(0!==(4294901760&t)?(t&=4294901760,16):0)|(0!==(4278255360&t)?(t&=4278255360,8):0)|(0!==(4042322160&t)?(t&=4042322160,4):0)|(0!==(3435973836&t)?(t&=3435973836,2):0)|0!==(2863311530&t)}async function Mi(t,e,n){const i=await t.read(2*e.G1.F.n8),r=e.G1.fromRprLEM(i,0);return n?e.G1.toObject(r):r}async function Ni(t,e,n){const i=await t.read(2*e.G2.F.n8),r=e.G2.fromRprLEM(i,0);return n?e.G2.toObject(r):r}async function Ti(t,e,n){await Fi(t,e,1);const i=await t.readULE32();if(await Ii(t),1==i)return await async function(t,e,n){const i={protocol:"groth16"};await Fi(t,e,2);const r=await t.readULE32();i.n8q=r,i.q=await Oi(t,r);const s=await t.readULE32();i.n8r=s,i.r=await Oi(t,s);let o=await zi(i.q);return i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=Ci(i.domainSize),i.vk_alpha_1=await Mi(t,o,n),i.vk_beta_1=await Mi(t,o,n),i.vk_beta_2=await Ni(t,o,n),i.vk_gamma_2=await Ni(t,o,n),i.vk_delta_1=await Mi(t,o,n),i.vk_delta_2=await Ni(t,o,n),await Ii(t),i}(t,e,n);if(2==i)return await async function(t,e,n,i){const r={protocol:"plonk"};await Fi(t,e,2);const s=await t.readULE32();r.n8q=s,r.q=await Oi(t,s);const o=await t.readULE32();r.n8r=o,r.r=await Oi(t,o);let a=await zi(r.q);return r.nVars=await t.readULE32(),r.nPublic=await t.readULE32(),r.domainSize=await t.readULE32(),r.power=Ci(r.domainSize),r.nAdditions=await t.readULE32(),r.nConstrains=await t.readULE32(),r.k1=await t.read(o),r.k2=await t.read(o),r.Qm=await Mi(t,a,i),r.Ql=await Mi(t,a,i),r.Qr=await Mi(t,a,i),r.Qo=await Mi(t,a,i),r.Qc=await Mi(t,a,i),r.S1=await Mi(t,a,i),r.S2=await Mi(t,a,i),r.S3=await Mi(t,a,i),r.X_2=await Ni(t,a,i),await Ii(t),r}(t,e);throw new Error("Protocol not supported: ")}async function ki(t,e,n){await Ei(t,1);const i=8*(Math.floor((ii.bitLength(n)-1)/64)+1);if(await t.writeULE32(i),await async function(t,e,n,i){const r=new Uint8Array(n);ii.toRprLE(r,0,e,n),await t.write(r,i)}(t,n,i),e.byteLength%i!=0)throw new Error("Invalid witness length");await t.writeULE32(e.byteLength/i),await Ai(t),await Ei(t,2),await t.write(e),await Ai(t)}async function Gi(t,e){await Fi(t,e,1);const n=await t.readULE32(),i=await Oi(t,n),r=await t.readULE32();return await Ii(t),{n8:n,q:i,nWitness:r}}const{stringifyBigInts:ji}=ri;async function Pi(t,e,n){const{fd:i,sections:r}=await Bi(e,"wtns",2),s=await Gi(i,r),{fd:o,sections:a}=await Bi(t,"zkey",2),h=await Ti(o,a);if("groth16"!=h.protocol)throw new Error("zkey file is not groth16");if(!ii.eq(h.r,s.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(s.nWitness!=h.nVars)throw new Error(`Invalid witness length. Circuit: ${h.nVars}, witness: ${s.nWitness}`);const f=await zi(h.q),u=f.Fr,c=f.G1,l=f.G2,p=Ci(h.domainSize);n&&n.debug("Reading Wtns");const g=await qi(i,r,2);n&&n.debug("Reading Coeffs");const m=await qi(o,a,4);n&&n.debug("Building ABC");const[d,b,w]=await async function(t,e,n,i,r){const s=t.Fr.n8,o=12+e.n8r,a=(i.byteLength-4)/o,h=new Mn(e.domainSize*s),f=new Mn(e.domainSize*s),u=new Mn(e.domainSize*s),c=[h,f];for(let l=0;l<a;l++){r&&l%1e6==0&&r.debug(`QAP AB: ${l}/${a}`);const e=i.slice(4+l*o,4+l*o+o),h=new DataView(e.buffer),f=h.getUint32(0,!0),u=h.getUint32(4,!0),p=h.getUint32(8,!0),g=e.slice(12,12+s);c[f].set(t.Fr.add(c[f].slice(u*s,u*s+s),t.Fr.mul(g,n.slice(p*s,p*s+s))),u*s)}for(let l=0;l<e.domainSize;l++)r&&l%1e6==0&&r.debug(`QAP C: ${l}/${e.domainSize}`),u.set(t.Fr.mul(h.slice(l*s,l*s+s),f.slice(l*s,l*s+s)),l*s);return[h,f,u]}(f,h,g,m,n),y=p==u.s?f.Fr.shift:f.Fr.w[p+1],v=await u.ifft(d,"","",n,"IFFT_A"),L=await u.batchApplyKey(v,u.e(1),y),_=await u.fft(L,"","",n,"FFT_A"),B=await u.ifft(b,"","",n,"IFFT_B"),E=await u.batchApplyKey(B,u.e(1),y),A=await u.fft(E,"","",n,"FFT_B"),F=await u.ifft(w,"","",n,"IFFT_C"),I=await u.batchApplyKey(F,u.e(1),y),O=await u.fft(I,"","",n,"FFT_C");n&&n.debug("Join ABC");const q=await async function(t,e,n,i,r,s){const o=1<<22,a=t.Fr.n8,h=Math.floor(n.byteLength/t.Fr.n8),f=[];for(let p=0;p<h;p+=o){s&&s.debug(`JoinABC: ${p}/${h}`);const e=Math.min(h-p,o),u=[],c=n.slice(p*a,(p+e)*a),l=i.slice(p*a,(p+e)*a),g=r.slice(p*a,(p+e)*a);u.push({cmd:"ALLOCSET",var:0,buff:c}),u.push({cmd:"ALLOCSET",var:1,buff:l}),u.push({cmd:"ALLOCSET",var:2,buff:g}),u.push({cmd:"ALLOC",var:3,len:e*a}),u.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:e},{var:3}]}),u.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:e},{var:3}]}),u.push({cmd:"GET",out:0,var:3,len:e*a}),f.push(t.tm.queueAction(u))}const u=await Promise.all(f);let c;c=n instanceof Mn?new Mn(n.byteLength):new Uint8Array(n.byteLength);let l=0;for(let p=0;p<u.length;p++)c.set(u[p][0],l),l+=u[p][0].byteLength;return c}(f,0,_,A,O,n);let S={};n&&n.debug("Reading A Points");const x=await qi(o,a,5);S.pi_a=await f.G1.multiExpAffine(x,g,n,"multiexp A"),n&&n.debug("Reading B1 Points");const z=await qi(o,a,6);let U=await f.G1.multiExpAffine(z,g,n,"multiexp B1");n&&n.debug("Reading B2 Points");const R=await qi(o,a,7);S.pi_b=await f.G2.multiExpAffine(R,g,n,"multiexp B2"),n&&n.debug("Reading C Points");const C=await qi(o,a,8);S.pi_c=await f.G1.multiExpAffine(C,g.slice((h.nPublic+1)*f.Fr.n8),n,"multiexp C"),n&&n.debug("Reading H Points");const M=await qi(o,a,9),N=await f.G1.multiExpAffine(M,q,n,"multiexp H"),T=f.Fr.random(),k=f.Fr.random();S.pi_a=c.add(S.pi_a,h.vk_alpha_1),S.pi_a=c.add(S.pi_a,c.timesFr(h.vk_delta_1,T)),S.pi_b=l.add(S.pi_b,h.vk_beta_2),S.pi_b=l.add(S.pi_b,l.timesFr(h.vk_delta_2,k)),U=c.add(U,h.vk_beta_1),U=c.add(U,c.timesFr(h.vk_delta_1,k)),S.pi_c=c.add(S.pi_c,N),S.pi_c=c.add(S.pi_c,c.timesFr(S.pi_a,k)),S.pi_c=c.add(S.pi_c,c.timesFr(U,T)),S.pi_c=c.add(S.pi_c,c.timesFr(h.vk_delta_1,u.neg(u.mul(T,k))));let G=[];for(let j=1;j<=h.nPublic;j++){const t=g.slice(j*u.n8,j*u.n8+u.n8);G.push(ii.fromRprLE(t))}return S.pi_a=c.toObject(c.toAffine(S.pi_a)),S.pi_b=l.toObject(l.toAffine(S.pi_b)),S.pi_c=c.toObject(c.toAffine(S.pi_c)),S.protocol="groth16",S.curve=f.name,await o.close(),await i.close(),S=ji(S),G=ji(G),{proof:S,publicSignals:G}}function $i(t){var e=[];return function t(e,n){if(Array.isArray(n))for(let i=0;i<n.length;i++)t(e,n[i]);else e.push(n)}(e,t),e}function Di(t){const e=BigInt(2)**BigInt(64);let n=BigInt("0xCBF29CE484222325");for(var i=0;i<t.length;i++)n^=BigInt(t[i].charCodeAt()),n*=BigInt(1099511628211),n%=e;let r=n.toString(16),s=16-r.length;return r="0".repeat(s).concat(r),r}function Zi(t,e){const n=[];let i=BigInt(t);const r=BigInt(4294967296);for(;i;)n.unshift(Number(i%r)),i/=r;if(e)for(var s=e-n.length;s>0;)n.unshift(0),s--;return n}class Wi{constructor(t,e,n){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=e,this.n32=(this.instance.exports.getFrLen()>>2)-2;const i=this.instance.exports.getPRawPrime(),r=new Array(this.n32);for(let s=0;s<this.n32;s++)r[this.n32-1-s]=this.i32[(i>>2)+s];this.prime=ii.fromArray(r,4294967296),this.Fr=new nn(this.prime),this.mask32=ii.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(ii.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=n}circom_version(){return 1}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const n=this.allocInt(),i=this.allocFr();Object.keys(t).forEach((e=>{const r=Di(e),s=parseInt(r.slice(0,8),16),o=parseInt(r.slice(8,16),16);try{this.instance.exports.getSignalOffset32(n,0,s,o)}catch(f){throw new Error(`Signal ${e} is not an input of the circuit.`)}const a=this.getInt(n),h=$i(t[e]);for(let t=0;t<h.length;t++)this.setFr(i,h[t]),this.instance.exports.setSignal(0,0,a+t,i)}))}async calculateWitness(t,e){const n=this,i=n.i32[0],r=[];await n._doCalculateWitness(t,e);for(let s=0;s<n.NVars;s++){const t=n.instance.exports.getPWitness(s);r.push(n.getFr(t))}return n.i32[0]=i,r}async calculateBinWitness(t,e){const n=this,i=n.i32[0];await n._doCalculateWitness(t,e);const r=n.instance.exports.getWitnessBuffer();n.i32[0]=i;const s=n.memory.buffer.slice(r,r+n.NVars*n.n64*8);return new Uint8Array(s)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,e){this.i32[t>>2]=e}getFr(t){const e=this,n=t>>2;if(2147483648&e.i32[n+1]){const t=new Array(e.n32);for(let i=0;i<e.n32;i++)t[e.n32-1-i]=e.i32[n+2+i];const r=e.Fr.e(ii.fromArray(t,4294967296));return 1073741824&e.i32[n+1]?(i=r,e.Fr.mul(e.RInv,i)):r}return 2147483648&e.i32[n]?e.Fr.e(e.i32[n]-4294967296):e.Fr.e(e.i32[n]);var i}setFr(t,e){const n=this;e=n.Fr.e(e);const i=n.Fr.neg(n.Fr.e("80000000",16)),r=n.Fr.e("7FFFFFFF",16);if(n.Fr.geq(e,i)&&n.Fr.leq(e,r)){let r;return n.Fr.geq(e,n.Fr.zero)?r=ii.toNumber(e):(r=ii.toNumber(n.Fr.sub(e,i)),r-=2147483648,r=4294967296+r),n.i32[t>>2]=r,void(n.i32[1+(t>>2)]=0)}n.i32[t>>2]=0,n.i32[1+(t>>2)]=2147483648;const s=ii.toArray(e,4294967296);for(let o=0;o<n.n32;o++){const e=s.length-1-o;n.i32[2+(t>>2)+o]=e>=0?s[e]:0}}}class Vi{constructor(t,e){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const n=new Array(this.n32);for(let i=0;i<this.n32;i++)n[this.n32-1-i]=this.instance.exports.readSharedRWMemory(i);this.prime=ii.fromArray(n,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=e}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const n=Object.keys(t);var i=0;if(n.forEach((e=>{const n=Di(e),r=parseInt(n.slice(0,8),16),s=parseInt(n.slice(8,16),16),o=$i(t[e]);for(let t=0;t<o.length;t++){const e=Zi(o[t],this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,e[this.n32-1-t]);try{this.instance.exports.setInputSignal(r,s,t),i++}catch(a){throw new Error(a)}}})),i<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${i} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,e){const n=[];await this._doCalculateWitness(t,e);for(let i=0;i<this.witnessSize;i++){this.instance.exports.getWitness(i);const t=new Uint32Array(this.n32);for(let e=0;e<this.n32;e++)t[this.n32-1-e]=this.instance.exports.readSharedRWMemory(e);n.push(fromArray32(t))}return n}async calculateWTNSBin(t,e){const n=new Uint32Array(this.witnessSize*this.n32+this.n32+11),i=new Uint8Array(n.buffer);await this._doCalculateWitness(t,e),i[0]="w".charCodeAt(0),i[1]="t".charCodeAt(0),i[2]="n".charCodeAt(0),i[3]="s".charCodeAt(0),n[1]=2,n[2]=2,n[3]=1;const r=4*this.n32,s=(8+r).toString(16);n[4]=parseInt(s.slice(0,8),16),n[5]=parseInt(s.slice(8,16),16),n[6]=r,this.instance.exports.getRawPrime();var o=7;for(let h=0;h<this.n32;h++)n[o+h]=this.instance.exports.readSharedRWMemory(h);n[o+=this.n32]=this.witnessSize,n[++o]=2,o++;const a=(r*this.witnessSize).toString(16);n[o]=parseInt(a.slice(0,8),16),n[o+1]=parseInt(a.slice(8,16),16),o+=2;for(let h=0;h<this.witnessSize;h++){this.instance.exports.getWitness(h);for(let t=0;t<this.n32;t++)n[o+t]=this.instance.exports.readSharedRWMemory(t);o+=this.n32}return i}}async function Ji(t,e,n,i){const r=await _i(e),s=await r.read(r.totalSize);await r.close();const o=await async function(t,e){e=e||{};let n,i=32767,r=!1;for(;!r;)try{n=new WebAssembly.Memory({initial:i}),r=!0}catch(u){if(1===i)throw u;console.warn("Could not allocate "+1024*i*64+" bytes. This may cause severe instability. Trying with "+1024*i*64/2+" bytes"),i=Math.floor(i/2)}const s=await WebAssembly.compile(t);let o;const a=await WebAssembly.instantiate(s,{env:{memory:n},runtime:{exceptionHandler:function(t){let e;throw e=1==t?"Signal not found. ":2==t?"Too many signals set. ":3==t?"Signal already set. ":4==t?"Assert Failed. ":5==t?"Not enough memory. ":"Unknown error.",console.log("ERROR: ",t,e),new Error(e)},showSharedRWMemory:function(){const t=a.exports.getFieldNumLen32(),e=new Uint32Array(t);for(let n=0;n<t;n++)e[t-1-n]=a.exports.readSharedRWMemory(n);console.log(ii.fromArray(e,4294967296))},error:function(t,n,i,r,s,a){let h;throw h=7==t?f(n)+" "+o.getFr(r).toString()+" != "+o.getFr(s).toString()+" "+f(a):9==t?f(n)+" "+o.getFr(r).toString()+" "+f(s):5==t&&e.sym?f(n)+" "+e.sym.labelIdx2Name[s]:f(n)+" "+i+" "+r+" "+s+" "+a,console.log("ERROR: ",t,h),new Error(h)},log:function(t){console.log(o.getFr(t).toString())},logGetSignal:function(t,n){e.logGetSignal&&e.logGetSignal(t,o.getFr(n))},logSetSignal:function(t,n){e.logSetSignal&&e.logSetSignal(t,o.getFr(n))},logStartComponent:function(t){e.logStartComponent&&e.logStartComponent(t)},logFinishComponent:function(t){e.logFinishComponent&&e.logFinishComponent(t)}}}),h=e&&(e.sanityCheck||e.logGetSignal||e.logSetSignal||e.logStartComponent||e.logFinishComponent);return o="function"==typeof a.exports.getVersion?new Vi(a,h):new Wi(n,a,h),o;function f(t){const e=new Uint8Array(n.buffer),i=[];for(let n=0;e[t+n]>0;n++)i.push(e[t+n]);return String.fromCharCode.apply(null,i)}}(s);if(1==o.circom_version()){const e=await o.calculateBinWitness(t),i=await async function(t,e,n,i,r,s){const o=await Li(t,r,s),a=new Uint8Array(4);for(let h=0;h<4;h++)a[h]=e.charCodeAt(h);return await o.write(a,0),await o.writeULE32(n),await o.writeULE32(i),o}(n,"wtns",2,2);await ki(i,e,o.prime),await i.close()}else{const e=await Li(n),i=await o.calculateWTNSBin(t);await e.write(i),await e.close()}}async function Hi(t,e,n,i){const r={type:"mem"};return await Ji(t,e,r),await Pi(n,r,i)}const{unstringifyBigInts:Qi}=ri;async function Ki(t,e,n,i){t=Qi(t),n=Qi(n),e=Qi(e);const r=await async function(t){let e;const n=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(n)>=0)e=await ei();else{if(!(["BLS12381"].indexOf(n)>=0))throw new Error(`Curve not supported: ${t}`);e=await ni()}return e}(t.curve),s=r.G1.fromObject(t.IC[0]),o=new Uint8Array(2*r.G1.F.n8*e.length),a=new Uint8Array(r.Fr.n8*e.length);for(let d=0;d<e.length;d++){const n=r.G1.fromObject(t.IC[d+1]);o.set(n,d*r.G1.F.n8*2),ii.toRprLE(a,r.Fr.n8*d,e[d],r.Fr.n8)}let h=await r.G1.multiExpAffine(o,a);h=r.G1.add(h,s);const f=r.G1.fromObject(n.pi_a),u=r.G2.fromObject(n.pi_b),c=r.G1.fromObject(n.pi_c),l=r.G2.fromObject(t.vk_gamma_2),p=r.G2.fromObject(t.vk_delta_2),g=r.G1.fromObject(t.vk_alpha_1),m=r.G2.fromObject(t.vk_beta_2);return await r.pairingEq(r.G1.neg(f),u,h,l,c,p,g,m)?(i&&i.info("OK!"),!0):(i&&i.error("Invalid proof"),!1)}ii.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ii.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const{stringifyBigInts:Xi}=ri;n(7083);var Yi=n(1094);const{stringifyBigInts:tr}=ri,{keccak256:er}=Yi;const{unstringifyBigInts:nr}=ri,{keccak256:ir}=Yi;function rr(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(void 0===t)throw new TypeError("Parameter '".concat(e,"' is not defined"));if(!n.includes(typeof t))throw new TypeError("Parameter '".concat(e,"' is none of these types: ").concat(n.join(", ")))}function sr(t,e,n,i,r,s,o){if(rr(t,"index","number"),t<0||t>=r[0].length)throw new Error("The leaf does not exist in this tree");for(var a=e,h=0;h<n;h+=1){var f=t-t%i,u=f+i,c=[];r[h][t]=a;for(var l=f;l<u;l+=1)l<r[h].length?c.push(r[h][l]):c.push(s[h]);a=o(c),t=Math.floor(t/i)}return a}var or=function(){function t(e,n,i,r){if(void 0===r&&(r=2),rr(e,"hash","function"),rr(n,"depth","number"),rr(i,"zeroValue","number","string","bigint"),rr(r,"arity","number"),n<1||n>t.maxDepth)throw new Error("The tree depth must be between 1 and 32");this._hash=e,this._depth=n,this._zeroes=[],this._nodes=[],this._arity=r;for(var s=0;s<n;s+=1)this._zeroes.push(i),this._nodes[s]=[],i=e(Array(this._arity).fill(i));this._root=i,Object.freeze(this._zeroes),Object.freeze(this._nodes)}return Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depth",{get:function(){return this._depth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leaves",{get:function(){return this._nodes[0].slice()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zeroes",{get:function(){return this._zeroes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"arity",{get:function(){return this._arity},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return function(t,e){return rr(t,"leaf","number","string","bigint"),e[0].indexOf(t)}(t,this._nodes)},t.prototype.insert=function(t){this._root=function(t,e,n,i,r,s){if(rr(t,"leaf","number","string","bigint"),i[0].length>=Math.pow(n,e))throw new Error("The tree is full");for(var o=t,a=i[0].length,h=0;h<e;h+=1){var f=a-a%n,u=f+n,c=[];i[h][a]=o;for(var l=f;l<u;l+=1)l<i[h].length?c.push(i[h][l]):c.push(r[h]);o=s(c),a=Math.floor(a/n)}return o}(t,this.depth,this.arity,this._nodes,this.zeroes,this._hash)},t.prototype.delete=function(t){this._root=sr(t,this.zeroes[0],this.depth,this.arity,this._nodes,this.zeroes,this._hash)},t.prototype.update=function(t,e){this._root=sr(t,e,this.depth,this.arity,this._nodes,this.zeroes,this._hash)},t.prototype.createProof=function(t){return function(t,e,n,i,r,s){if(rr(t,"index","number"),t<0||t>=i[0].length)throw new Error("The leaf does not exist in this tree");for(var o=[],a=[],h=t,f=0;f<e;f+=1){var u=t%n,c=t-u,l=c+n;a[f]=u,o[f]=[];for(var p=c;p<l;p+=1)p!==t&&(p<i[f].length?o[f].push(i[f][p]):o[f].push(r[f]));t=Math.floor(t/n)}return{root:s,leaf:i[0][h],pathIndices:a,siblings:o}}(t,this.depth,this.arity,this._nodes,this.zeroes,this.root)},t.prototype.verifyProof=function(t){return function(t,e){rr(t,"proof","object"),rr(t.root,"proof.root","number","string","bigint"),rr(t.leaf,"proof.leaf","number","string","bigint"),rr(t.siblings,"proof.siblings","object"),rr(t.pathIndices,"proof.pathElements","object");for(var n=t.leaf,i=0;i<t.siblings.length;i+=1){var r=t.siblings[i].slice();r.splice(t.pathIndices[i],0,n),n=e(r)}return t.root===n}(t,this._hash)},t.maxDepth=32,t}();const ar=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function hr(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const fr=hr;function ur(t,e){let n=BigInt(0);e=BigInt(e);for(let i=0;i<t.length;i++)n=n*e+BigInt(t[i]);return n}function cr(t){const e=t.toString(16);return 4*(e.length-1)+ar[parseInt(e[0],16)]}function lr(t){return BigInt(t)<BigInt(0)}function pr(t){return!t}function gr(t,e){return BigInt(t)<<BigInt(e)}function mr(t,e){return BigInt(t)>>BigInt(e)}const dr=gr,br=mr;function wr(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function yr(t){let e=BigInt(t);const n=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));n.push(t),e-=BigInt(t)}else n.push(0);e>>=BigInt(1)}return n}function vr(t){let e=BigInt(t);const n=[];for(;e;)e&BigInt(1)?n.push(1):n.push(0),e>>=BigInt(1);return n}function Lr(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)}function _r(t,e){const n=[];let i=BigInt(t);for(e=BigInt(e);i;)n.unshift(Number(i%e)),i/=e;return n}function Br(t,e){return BigInt(t)+BigInt(e)}function Er(t,e){return BigInt(t)-BigInt(e)}function Ar(t){return-BigInt(t)}function Fr(t,e){return BigInt(t)*BigInt(e)}function Ir(t){return BigInt(t)*BigInt(t)}function Or(t,e){return BigInt(t)**BigInt(e)}function qr(t,e){return BigInt(t)**BigInt(e)}function Sr(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)}function xr(t,e){return BigInt(t)/BigInt(e)}function zr(t,e){return BigInt(t)%BigInt(e)}function Ur(t,e){return BigInt(t)==BigInt(e)}function Rr(t,e){return BigInt(t)!=BigInt(e)}function Cr(t,e){return BigInt(t)<BigInt(e)}function Mr(t,e){return BigInt(t)>BigInt(e)}function Nr(t,e){return BigInt(t)<=BigInt(e)}function Tr(t,e){return BigInt(t)>=BigInt(e)}function kr(t,e){return BigInt(t)&BigInt(e)}function Gr(t,e){return BigInt(t)|BigInt(e)}function jr(t,e){return BigInt(t)^BigInt(e)}function Pr(t,e){return BigInt(t)&&BigInt(e)}function $r(t,e){return BigInt(t)||BigInt(e)}function Dr(t){return!BigInt(t)}function Zr(t,e){return"string"==typeof t&&"0x"==t.slice(0,2)?lt(t.slice(2),16):lt(t,e)}const Wr=Zr;function Vr(t,e){return lt.fromArray(t,e)}function Jr(t){return lt(t).bitLength()}function Hr(t){return lt(t).isNegative()}function Qr(t){return lt(t).isZero()}function Kr(t,e){return lt(t).shiftLeft(e)}function Xr(t,e){return lt(t).shiftRight(e)}const Yr=Kr,ts=Xr;function es(t){return lt(t).isOdd()}function ns(t){let e=lt(t);const n=[];for(;e.gt(lt.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();n.push(t),e=e.minus(t)}else n.push(0);e=e.shiftRight(1)}return n}function is(t){let e=lt(t);const n=[];for(;e.gt(lt.zero);)e.isOdd()?n.push(1):n.push(0),e=e.shiftRight(1);return n}function rs(t){if(!t.lt(lt("9007199254740992",10)))throw new Error("Number too big");return t.toJSNumber()}function ss(t,e){return lt(t).toArray(e)}function os(t,e){return lt(t).add(lt(e))}function as(t,e){return lt(t).minus(lt(e))}function hs(t){return lt.zero.minus(lt(t))}function fs(t,e){return lt(t).times(lt(e))}function us(t){return lt(t).square()}function cs(t,e){return lt(t).pow(lt(e))}function ls(t,e){return lt(t).pow(lt(e))}function ps(t){return lt(t).abs()}function gs(t,e){return lt(t).divide(lt(e))}function ms(t,e){return lt(t).mod(lt(e))}function ds(t,e){return lt(t).eq(lt(e))}function bs(t,e){return lt(t).neq(lt(e))}function ws(t,e){return lt(t).lt(lt(e))}function ys(t,e){return lt(t).gt(lt(e))}function vs(t,e){return lt(t).leq(lt(e))}function Ls(t,e){return lt(t).geq(lt(e))}function _s(t,e){return lt(t).and(lt(e))}function Bs(t,e){return lt(t).or(lt(e))}function Es(t,e){return lt(t).xor(lt(e))}function As(t,e){return!lt(t).isZero()&&!lt(e).isZero()}function Fs(t,e){return!lt(t).isZero()||!lt(e).isZero()}function Is(t){return lt(t).isZero()}const Os="function"===typeof BigInt;let qs={};Os?Object.assign(qs,f):Object.assign(qs,u),qs.toRprLE=function(t,e,n,i){const r="0000000"+n.toString(16),s=new Uint32Array(t.buffer,e,i/4),o=1+(4*(r.length-7)-1>>5);for(let a=0;a<o;a++)s[a]=parseInt(r.substring(r.length-8*a-8,r.length-8*a),16);for(let a=o;a<s.length;a++)s[a]=0;for(let a=4*s.length;a<i;a++)t[a]=qs.toNumber(qs.band(qs.shiftRight(n,8*a),255))},qs.toRprBE=function(t,e,n,i){const r="0000000"+n.toString(16),s=new DataView(t.buffer,t.byteOffset+e,i),o=1+(4*(r.length-7)-1>>5);for(let a=0;a<o;a++)s.setUint32(i-4*a-4,parseInt(r.substring(r.length-8*a-8,r.length-8*a),16),!1);for(let a=0;a<i/4-o;a++)s[a]=0},qs.fromRprLE=function(t,e,n){n=n||t.byteLength,e=e||0;const i=new Uint32Array(t.buffer,e,n/4),r=new Array(n/4);return i.forEach(((t,e)=>r[r.length-e-1]=t.toString(16).padStart(8,"0"))),qs.fromString(r.join(""),16)},qs.fromRprBE=function(t,e,n){n=n||t.byteLength,e=e||0;const i=new DataView(t.buffer,t.byteOffset+e,n),r=new Array(n/4);for(let s=0;s<n/4;s++)r[s]=i.getUint32(4*s,!1).toString(16).padStart(8,"0");return qs.fromString(r.join(""),16)},qs.toString=function(t,e){return t.toString(e)},qs.toLEBuff=function(t){const e=new Uint8Array(Math.floor((qs.bitLength(t)-1)/8)+1);return qs.toRprLE(e,0,t,e.byteLength),e},qs.zero=qs.e(0),qs.one=qs.e(1);let{toRprLE:Ss,toRprBE:xs,fromRprLE:zs,fromRprBE:Us,toString:Rs,toLEBuff:Cs,zero:Ms,one:Ns,fromString:Ts,e:ks,fromArray:Gs,bitLength:js,isNegative:Ps,isZero:$s,shiftLeft:Ds,shiftRight:Zs,shl:Ws,shr:Vs,isOdd:Js,naf:Hs,bits:Qs,toNumber:Ks,toArray:Xs,add:Ys,sub:to,neg:eo,mul:no,square:io,pow:ro,exp:so,abs:oo,div:ao,mod:ho,eq:fo,neq:uo,lt:co,gt:lo,leq:po,geq:go,band:mo,bor:bo,bxor:wo,land:yo,lor:vo,lnot:Lo}=qs;const _o=[];for(let ca=0;ca<256;ca++)_o[ca]=Bo(ca,8);function Bo(t,e){let n=0,i=t;for(let r=0;r<e;r++)n<<=1,n|=1&i,i>>=1;return n}function Eo(t,e,n){if($s(n))return t.one;const i=Qs(n);if(0==i.legth)return t.one;let r=e;for(let s=i.length-2;s>=0;s--)r=t.square(r),i[s]&&(r=t.mul(r,e));return r}function Ao(t){if(t.m%2==1)if(fo(ho(t.p,4),1))if(fo(ho(t.p,8),1))if(fo(ho(t.p,16),1))!function(t){t.sqrt_q=ro(t.p,t.m),t.sqrt_s=0,t.sqrt_t=to(t.sqrt_q,1);for(;!Js(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=ao(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){const n=t.random();t.sqrt_z=t.pow(n,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=ao(to(t.sqrt_t,1),2),t.sqrt=function(t){const e=this;if(e.isZero(t))return e.zero;let n=e.pow(t,e.sqrt_tm1d2);const i=e.pow(e.mul(e.square(n),t),2**(e.sqrt_s-1));if(e.eq(i,e.negone))return null;let r=e.sqrt_s,s=e.mul(t,n),o=e.mul(s,n),a=e.sqrt_z;for(;!e.eq(o,e.one);){let t=e.square(o),i=1;for(;!e.eq(t,e.one);)t=e.square(t),i++;n=a;for(let s=0;s<r-i-1;s++)n=e.square(n);a=e.square(n),o=e.mul(o,a),s=e.mul(s,n),r=i}return e.geq(s,e.zero)?s:e.neg(s)}}(t);else{if(!fo(ho(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!fo(ho(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else fo(ho(t.p,4),3)&&function(t){t.sqrt_q=ro(t.p,t.m),t.sqrt_e1=ao(to(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;const n=this.pow(e,this.sqrt_e1),i=this.mul(this.square(n),e);if(this.eq(i,this.negone))return null;const r=this.mul(n,e);return t.geq(r,t.zero)?r:t.neg(r)}}(t);else{const e=ho(ro(t.p,t.m/2),4);1==e?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==e?function(t){t.sqrt_q=ro(t.p,t.m/2),t.sqrt_e34=ao(to(t.sqrt_q,3),4),t.sqrt_e12=ao(to(t.sqrt_q,1),2),t.frobenius=function(e,n){return e%2==1?t.conjugate(n):n},t.sqrt=function(t){const e=this,n=e.pow(t,e.sqrt_e34),i=e.mul(e.square(n),t),r=e.mul(e.frobenius(1,i),i);if(e.eq(r,e.negone))return null;const s=e.mul(n,t);let o;if(e.eq(i,e.negone))o=e.mul(s,[e.F.zero,e.F.one]);else{const t=e.pow(e.add(e.one,i),e.sqrt_e12);o=e.mul(t,s)}return e.geq(o,e.zero)?o:e.neg(o)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}var Fo=n(232);function Io(t){let e=new Uint8Array(t);if("undefined"!==typeof window)if("undefined"!==typeof window.crypto)window.crypto.getRandomValues(e);else for(let n=0;n<t;n++)e[n]=4294967296*Math.random()>>>0;else Fo.randomFillSync(e);return e}class Oo{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=js(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const e=this.negone>>this.one;this.nqr=this.two;let n=this.pow(this.nqr,e);for(;!this.eq(n,this.negone);)this.nqr=this.nqr+this.one,n=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),Ao(this)}e(t,e){let n;if(e?16==e&&(n=BigInt("0x"+t)):n=BigInt(t),n<0){let t=-n;return t>=this.p&&(t%=this.p),this.p-t}return n>=this.p?n%this.p:n}add(t,e){const n=t+e;return n>=this.p?n-this.p:n}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw new Error("Division by zero");return t/e}inv(t){if(!t)throw new Error("Division by zero");let e=this.zero,n=this.p,i=this.one,r=t%this.p;for(;r;){let t=n/r;[e,i]=[i,e-t*i],[n,r]=[r,n-t*r]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return Eo(this,t,e)}exp(t,e){return Eo(this,t,e)}band(t,e){const n=t&e&this.mask;return n>=this.p?n-this.p:n}bor(t,e){const n=(t|e)&this.mask;return n>=this.p?n-this.p:n}bxor(t,e){const n=(t^e)&this.mask;return n>=this.p?n-this.p:n}bnot(t){const e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){const n=t<<e&this.mask;return n>=this.p?n-this.p:n}{const n=this.p-e;return Number(n)<this.bitLength?t>>n:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{const n=this.p-e;if(Number(n)<this.bitLength){const e=t<<n&this.mask;return e>=this.p?e-this.p:e}return 0}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,n=this.nqr_to_t,i=this.pow(t,this.t),r=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),s=1;for(;t!=this.one;)s++,t=this.square(t);let o=n;for(let n=0;n<e-s-1;n++)o=this.square(o);e=s,n=this.square(o),i=this.mul(i,n),r=this.mul(r,o)}return r>this.p>>this.one&&(r=this.neg(r)),r}normalize(t,e){if((t=BigInt(t,e))<0){let e=-t;return e>=this.p&&(e%=this.p),this.p-e}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let e=this.zero;for(let n=0;n<t;n++)e=(e<<BigInt(8))+BigInt(Io(1)[0]);return e%this.p}toString(t,e){let n;if(t>this.half){n="-"+(this.p-t).toString(e)}else n=t.toString(e);return n}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let n=0;n<this.n64;n++)e+=t.nextU64()<<BigInt(64*n);e&=this.mask}while(e>=this.p);return e=e*this.Ri%this.p,e}}class qo{constructor(t){this.type="F1",this.one=lt.one,this.zero=lt.zero,this.p=lt(t),this.m=1,this.negone=this.p.minus(lt.one),this.two=lt(2),this.half=this.p.shiftRight(1),this.bitLength=this.p.bitLength(),this.mask=lt.one.shiftLeft(this.bitLength).minus(lt.one),this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=lt.one.shiftLeft(64*this.n64),this.Ri=this.inv(this.R);const e=this.negone.shiftRight(this.one);this.nqr=this.two;let n=this.pow(this.nqr,e);for(;!n.equals(this.negone);)this.nqr=this.nqr.add(this.one),n=this.pow(this.nqr,e);for(this.s=this.zero,this.t=this.negone;!this.t.isOdd();)this.s=this.s.add(this.one),this.t=this.t.shiftRight(this.one);this.nqr_to_t=this.pow(this.nqr,this.t),Ao(this)}e(t,e){const n=lt(t,e);return this.normalize(n)}add(t,e){let n=t.add(e);return n.geq(this.p)&&(n=n.minus(this.p)),n}sub(t,e){return t.geq(e)?t.minus(e):this.p.minus(e.minus(t))}neg(t){return t.isZero()?t:this.p.minus(t)}mul(t,e){return t.times(e).mod(this.p)}mulScalar(t,e){return t.times(lt(e)).mod(this.p)}square(t){return t.square().mod(this.p)}eq(t,e){return t.eq(e)}neq(t,e){return t.neq(e)}lt(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.lt(i)}gt(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.gt(i)}leq(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.leq(i)}geq(t,e){const n=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return n.geq(i)}div(t,e){if(e.isZero())throw new Error("Division by zero");return t.times(e.modInv(this.p)).mod(this.p)}idiv(t,e){if(e.isZero())throw new Error("Division by zero");return t.divide(e)}inv(t){if(t.isZero())throw new Error("Division by zero");return t.modInv(this.p)}mod(t,e){return t.mod(e)}pow(t,e){return t.modPow(e,this.p)}exp(t,e){return t.modPow(e,this.p)}band(t,e){return t.and(e).and(this.mask).mod(this.p)}bor(t,e){return t.or(e).and(this.mask).mod(this.p)}bxor(t,e){return t.xor(e).and(this.mask).mod(this.p)}bnot(t){return t.xor(this.mask).mod(this.p)}shl(t,e){if(e.lt(this.bitLength))return t.shiftLeft(e).and(this.mask).mod(this.p);{const n=this.p.minus(e);return n.lt(this.bitLength)?this.shr(t,n):lt.zero}}shr(t,e){if(e.lt(this.bitLength))return t.shiftRight(e);{const n=this.p.minus(e);return n.lt(this.bitLength)?this.shl(t,n):lt.zero}}land(t,e){return t.isZero()||e.isZero()?lt.zero:lt.one}lor(t,e){return t.isZero()&&e.isZero()?lt.zero:lt.one}lnot(t){return t.isZero()?lt.one:lt.zero}sqrt_old(t){if(t.equals(this.zero))return this.zero;if(!this.pow(t,this.negone.shiftRight(this.one)).equals(this.one))return null;let e=parseInt(this.s),n=this.nqr_to_t,i=this.pow(t,this.t),r=this.pow(t,this.add(this.t,this.one).shiftRight(this.one));for(;!i.equals(this.one);){let t=this.square(i),s=1;for(;!t.equals(this.one);)s++,t=this.square(t);let o=n;for(let n=0;n<e-s-1;n++)o=this.square(o);e=s,n=this.square(o),i=this.mul(i,n),r=this.mul(r,o)}return r.greater(this.p.shiftRight(this.one))&&(r=this.neg(r)),r}normalize(t){return(t=lt(t)).isNegative()?this.p.minus(t.abs().mod(this.p)):t.mod(this.p)}random(){let t=lt(0),e=lt(this.p.square());for(;!e.isZero();)t=t.shiftLeft(8).add(lt(Io(1)[0])),e=e.shiftRight(8);return t.mod(this.p)}toString(t,e){let n;if(t.lesserOrEquals(this.p.shiftRight(lt(1))))n=t.toString(e);else{n="-"+this.p.minus(t).toString(e)}return n}isZero(t){return t.isZero()}fromRng(t){let e;do{e=lt(0);for(let n=0;n<this.n64;n++)e=e.add(e,t.nextU64().shiftLeft(64*n));e=e.and(this.mask)}while(e.geq(this.p));return e=e.times(this.Ri).mod(this.q),e}}const So="function"===typeof BigInt;let xo;xo=So?Oo:qo;n(9888);function zo(t){if("bigint"==typeof t||void 0!==t.eq)return t.toString(10);if(t instanceof Uint8Array)return zs(t,0);if(Array.isArray(t))return t.map(zo);if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=zo(t[n])})),e}return t}function Uo(t){if("string"==typeof t&&/^[0-9]+$/.test(t))return BigInt(t);if("string"==typeof t&&/^0x[0-9a-fA-F]+$/.test(t))return BigInt(t);if(Array.isArray(t))return t.map(Uo);if("object"==typeof t){if(null===t)return null;const e={};return Object.keys(t).forEach((n=>{e[n]=Uo(t[n])})),e}return t}function Ro(t){let e=BigInt(0),n=t.length,i=0;const r=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n>0;)n>=4?(n-=4,e+=BigInt(r.getUint32(n))<<BigInt(8*i),i+=4):n>=2?(n-=2,e+=BigInt(r.getUint16(n))<<BigInt(8*i),i+=2):(n-=1,e+=BigInt(r.getUint8(n))<<BigInt(8*i),i+=1);return e}function Co(t,e){let n=t;const i=new Uint8Array(e),r=new DataView(i.buffer);let s=e;for(;s>0;)s-4>=0?(s-=4,r.setUint32(s,Number(n&BigInt(4294967295))),n>>=BigInt(32)):s-2>=0?(s-=2,r.setUint16(s,Number(n&BigInt(65535))),n>>=BigInt(16)):(s-=1,r.setUint8(s,Number(n&BigInt(255))),n>>=BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function Mo(t){let e=BigInt(0),n=0;const i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n<t.length;)n+4<=t.length?(e+=BigInt(i.getUint32(n,!0))<<BigInt(8*n),n+=4):n+4<=t.length?(e+=BigInt(i.getUint16(n,!0))<<BigInt(8*n),n+=2):(e+=BigInt(i.getUint8(n,!0))<<BigInt(8*n),n+=1);return e}function No(t,e){let n=t;"undefined"===typeof e&&0==(e=Math.floor((js(t)-1)/8)+1)&&(e=1);const i=new Uint8Array(e),r=new DataView(i.buffer);let s=0;for(;s<e;)s+4<=e?(r.setUint32(s,Number(n&BigInt(4294967295)),!0),s+=4,n>>=BigInt(32)):s+2<=e?(r.setUint16(Number(s,n&BigInt(65535)),!0),s+=2,n>>=BigInt(16)):(r.setUint8(Number(s,n&BigInt(255)),!0),s+=1,n>>=BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function To(t){if("bigint"==typeof t||void 0!==t.eq)return t.toString(10);if(Array.isArray(t))return t.map(To);if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=To(t[n])})),e}return t}function ko(t){if("string"==typeof t&&/^[0-9]+$/.test(t))return lt(t);if("string"==typeof t&&/^0x[0-9a-fA-F]+$/.test(t))return lt(t);if(Array.isArray(t))return t.map(ko);if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=ko(t[n])})),e}return t}function Go(t){let e=lt.zero;for(let n=0;n<t.length;n++){const i=lt(t[t.length-n-1]);e=e.add(i.shiftLeft(8*n))}return e}function jo(t,e){let n=t,i=e-1;const r=new Uint8Array(e);for(;n.gt(lt.zero)&&i>=0;){let t=Number(n.and(lt("255")));r[i]=t,i--,n=n.shiftRight(8)}if(!n.eq(lt.zero))throw new Error("Number does not fit in this length");return r}function Po(t){let e=lt.zero;for(let n=0;n<t.length;n++){const i=lt(t[n]);e=e.add(i.shiftLeft(8*n))}return e}function $o(t,e){let n=t,i=0;const r=new Uint8Array(e);for(;n.gt(lt.zero)&&i<r.length;){let t=Number(n.and(lt(255)));r[i]=t,i++,n=n.shiftRight(8)}if(!n.eq(lt.zero))throw new Error("Number does not fit in this length");return r}let Do={};"function"===typeof BigInt?Object.assign(Do,c):Object.assign(Do,l);const Zo=[];for(let ca=0;ca<256;ca++)Zo[ca]=Wo(ca,8);function Wo(t,e){let n=0,i=t;for(let r=0;r<e;r++)n<<=1,n|=1&i,i>>=1;return n}Do.bitReverse=function(t,e){return(Zo[t>>>24]|Zo[t>>>16&255]<<8|Zo[t>>>8&255]<<16|Zo[255&t]<<24)>>>32-e},Do.log2=function(t){return(0!==(4294901760&t)?(t&=4294901760,16):0)|(0!==(4278255360&t)?(t&=4278255360,8):0)|(0!==(4042322160&t)?(t&=4042322160,4):0)|(0!==(3435973836&t)?(t&=3435973836,2):0)|0!==(2863311530&t)},Do.buffReverseBits=function(t,e){const n=t.byteLength/e,i=Do.log2(n);if(n!=1<<i)throw new Error("Invalid number of pointers");for(let r=0;r<n;r++){const n=Do.bitReverse(r,i);if(r>n){const i=t.slice(r*e,(r+1)*e);t.set(t.slice(n*e,(n+1)*e),r*e),t.set(i,n*e)}}};let{bitReverse:Vo,log2:Jo,buffReverseBits:Ho,stringifyBigInts:Qo,unstringifyBigInts:Ko,beBuff2int:Xo,beInt2Buff:Yo,leBuff2int:ta,leInt2Buff:ea}=Do;var na=n(4155);n(8638);!function(t){window.btoa(t)}("("+function(t){const e=32767;let n,i;async function r(t){const r=new Uint8Array(t.code),s=await WebAssembly.compile(r);i=new WebAssembly.Memory({initial:t.init,maximum:e}),n=await WebAssembly.instantiate(s,{env:{memory:i}})}function s(t){const n=new Uint32Array(i.buffer,0,1);for(;3&n[0];)n[0]++;const r=n[0];if(n[0]+=t,n[0]+t>i.buffer.byteLength){const r=i.buffer.byteLength/65536;let s=Math.floor((n[0]+t)/65536)+1;s>e&&(s=e),i.grow(s-r)}return r}function o(t){const e=s(t.byteLength);return h(e,t),e}function a(t,e){const n=new Uint8Array(i.buffer);return new Uint8Array(n.buffer,n.byteOffset+t,e)}function h(t,e){new Uint8Array(i.buffer).set(new Uint8Array(e),t)}function f(t){if("INIT"==t[0].cmd)return r(t[0]);const e={vars:[],out:[]},f=new Uint32Array(i.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":e.vars[t[i].var]=o(t[i].buff);break;case"ALLOC":e.vars[t[i].var]=s(t[i].len);break;case"SET":h(e.vars[t[i].var],t[i].buff);break;case"CALL":{const r=[];for(let n=0;n<t[i].params.length;n++){const s=t[i].params[n];"undefined"!==typeof s.var?r.push(e.vars[s.var]+(s.offset||0)):"undefined"!=typeof s.val&&r.push(s.val)}n.exports[t[i].fnName](...r);break}case"GET":e.out[t[i].out]=a(e.vars[t[i].var],t[i].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(i.buffer,0,1)[0]=f,e.out}return t&&(t.onmessage=function(e){let n;if(n=e.data?e.data:e,"INIT"==n[0].cmd)r(n[0]).then((function(){t.postMessage(n.result)}));else if("TERMINATE"==n[0].cmd)na.exit();else{const e=f(n);t.postMessage(e)}}),f}.toString()+")(self)");var ia=n(8908);ia.curve_bn128=null;var ra=n(8908);ra.curve_bls12381=null;ks("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ks("21888242871839275222246405745257275088548364400416034343698204186575808495617"),ks("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ks("21888242871839275222246405745257275088696311157297823662689037894645226208583");function sa(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(S){s(S)}}function a(t){try{h(i.throw(t))}catch(S){s(S)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function oa(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(S){s=[6,S],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var aa=BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),ha=new class extends xo{toRprLE(t,e,n){Ss(t,e,n,8*this.n64)}toRprBE(t,e,n){xs(t,e,n,8*this.n64)}toRprBEM(t,e,n){return this.toRprBE(t,e,this.mul(this.R,n))}toRprLEM(t,e,n){return this.toRprLE(t,e,this.mul(this.R,n))}fromRprLE(t,e){return zs(t,e,this.n8)}fromRprBE(t,e){return Us(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}}(aa);function fa(t,e,n,i){if(i===e)throw new Error("Can't generate a proof for a zero leaf");var r=function(t,e,n){for(var i=new or(I.poseidon,t,e,2),r=0,s=n;r<s.length;r++){var o=s[r];i.insert(BigInt(o))}return i}(t,e,n),s=r.leaves.indexOf(BigInt(i));if(-1===s)throw new Error("The leaf does not exists");var o=r.createProof(s);return o.siblings=o.siblings.map((function(t){return t[0]})),o}!function(){function t(){}t.genProof=function(t,e,n){return sa(this,void 0,void 0,(function(){var i,r,s;return oa(this,(function(o){switch(o.label){case 0:return[4,Hi(t,e,n,null)];case 1:return i=o.sent(),r=i.proof,s=i.publicSignals,[2,{proof:r,publicSignals:{yShare:s[0],merkleRoot:s[1],internalNullifier:s[2],signalHash:s[3],epoch:s[4],rlnIdentifier:s[5]}}]}}))}))},t.verifyProof=function(t,e){var n=e.proof,i=e.publicSignals;return Ki(t,[i.yShare,i.merkleRoot,i.internalNullifier,i.signalHash,i.epoch,i.rlnIdentifier],n)},t.genWitness=function(e,n,i,r,s,o){return void 0===o&&(o=!0),{identity_secret:e,path_elements:n.siblings,identity_path_index:n.pathIndices,x:o?t.genSignalHash(r):r,epoch:i,rln_identifier:s}},t.calculateOutput=function(e,n,i,r){var s=(0,I.poseidon)([e,n]);return[ha.normalize(s*r+e),t.genNullifier(s,i)]},t.genNullifier=function(t,e){return(0,I.poseidon)([t,e])},t.genSignalHash=function(t){var e=(0,p.Dv)((0,d.Y0)(t));return BigInt(E(["bytes"],[e]))>>BigInt(8)},t.retrieveSecret=function(t,e,n,i){var r=ha.div(ha.sub(i,n),ha.sub(e,t)),s=ha.sub(n,ha.mul(r,t));return ha.normalize(s)},t.genIdentifier=function(){return ha.random()}}();var ua=function(){function t(){}return t.genProof=function(t,e,n){return sa(this,void 0,void 0,(function(){var i,r,s;return oa(this,(function(o){switch(o.label){case 0:return[4,Hi(t,e,n,null)];case 1:return i=o.sent(),r=i.proof,s=i.publicSignals,[2,{proof:r,publicSignals:{merkleRoot:s[0],nullifierHash:s[1],signalHash:s[2],externalNullifier:s[3]}}]}}))}))},t.verifyProof=function(t,e){var n=e.proof,i=e.publicSignals;return Ki(t,[i.merkleRoot,i.nullifierHash,i.signalHash,i.externalNullifier],n)},t.genWitness=function(e,n,i,r,s){return{identityNullifier:n,identityTrapdoor:e,treePathIndices:i.pathIndices,treeSiblings:i.siblings,externalNullifier:r,signalHash:t.genSignalHash(s)}},t.genNullifierHash=function(t,e){return(0,I.poseidon)([BigInt(t),BigInt(e)])},t.genSignalHash=function(t){return BigInt(E(["bytes32"],[F(t)]))>>BigInt(8)},t.packToSolidityProof=function(t){return[t.pi_a[0],t.pi_a[1],t.pi_b[0][1],t.pi_b[0][0],t.pi_b[1][1],t.pi_b[1][0],t.pi_c[0],t.pi_c[1]]},t}()},3558:function(t){"use strict";t.exports={i8:"3.1.6"}}}]);